<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>High School Opportunity Structures</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="HS Opp Structures_files/libs/clipboard/clipboard.min.js"></script>
<script src="HS Opp Structures_files/libs/quarto-html/quarto.js"></script>
<script src="HS Opp Structures_files/libs/quarto-html/popper.min.js"></script>
<script src="HS Opp Structures_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="HS Opp Structures_files/libs/quarto-html/anchor.min.js"></script>
<link href="HS Opp Structures_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="HS Opp Structures_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="HS Opp Structures_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="HS Opp Structures_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="HS Opp Structures_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">High School Opportunity Structures</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: Prolog</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># PURPOSE: overall, 50K ft description</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># DIR:     list directories for files here</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># DATA:    filenames w/ correct extension</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#          or web address if applicable</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># EDITED:  date code last edited</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># RUN:     date code last run</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="do">## comment</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Save core files for upload to VCE</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="do">## 1. Load libraries</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="do">## 2. CENSUS: Download county-level shapefile (using tigris) - NAD83</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 3. CENSUS: Download data for county-level opportunity structure indicators</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     - race, median income, poverty, IPR, ed attain, industry, unemployment</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     --- Option, use tigris, include geometry</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="do">###           CHALLENGE: # cases incr exponentially when later use st_join to merge</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     --- Option, use tigris, exlude geometry</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="do">###           CHALLENGE: geometry drops when later join sf/df using left_join</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="do">###             CHOSEN SOLUTION: Download attrib data as df, merge Census/CCD b4</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="do">###             merge to sf b/c CCD file incl lat/long coords </span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="do">###             SURPRISE!: Appears not all counties reflected in CCD data</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="do">## 4. NCES: Download/save NCES CCD files</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="do">## 5. CENSUS: Initial cleaning - Census files</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co">#     - rename vars, e.g., 02001_002 -&gt; White, etc., combine categories, pivot </span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co">#          wide, drop outlying areas, run basic descriptives</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co">#     --- CHALLENGE: Rounding w/ median income data</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="do">## 6. CENSUS: Drop outlying areas in sf, merge Census dataframes</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="do">## 7. NCES: Initial cleaning, file merge - CCD files</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="co">#     - drop outlying areas, keep only needed vars, fix FIPS code, merge all </span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="co">#     --- CHALLENGE?: Have x/xx, y/yy lat/long? - used left_join</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co">#  8. COMBINED: Merge CCD/Census dfs, the merge w/ Census county-level sf</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="co">#     - pad CCD FIPS for merge, use left_join to merge CCD/Census dfs,</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="co">#          add CRS to merged df</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="co">#     --- CHALLENGE: ~316 cases no lat/long - in Census but not CCD (2009BY)</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="co">#           CHOSEN SOLUTION: Drop cases no coords, then merge</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="co">#     --- CHALLENGE: Bounding box range potentially invalid - not sure how to </span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="co">#           correct. Map is a disaster. </span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a><span class="co">#     *** FINAL REQUIREMENT: Use at least 5 datasets -&gt; 12 used</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="do">## 9. ANALYSIS: Look at spatial autocorrelation, spatial matrix</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="co">#     --- CHALLENGE: Error message, can't interpret X as point pattern - improper</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a><span class="co">#           data projection? Limits all further analysis</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a><span class="co"># 10. ANALYSIS: Conduct logistic regression</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a><span class="co">#     *** FINAL REQUIREMENT: Select class of analysis, justify choice, assess</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a><span class="co">#           whether data meet assumptions, evaluate implications of key</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a><span class="co">#           assumptions, e.g., model fit?</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a><span class="co">#    --- CHALLENGE: Need to address prior issues to run</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a><span class="co"># 11. VISUALIZATIONS: Minimum of 3, </span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a><span class="co">#     *** FINAL REQUIREMENT: One should be pub quality, help you tell your story.</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a><span class="co"># 12. REPORTING: Manuscript style doc</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a><span class="co">#     *** FINAL REQUIREMENT: 1-2 paragraph description of question and why </span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a><span class="co">#           interested; methods section with subsections describing data sources,</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a><span class="co">#           processing steps taken/why, and analysis process. Show/annotate code;</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a><span class="co">#           results section w/ tabular results, visualizations; Discussion of </span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a><span class="co">#           results in context of research question, considers alternative </span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a><span class="co">#           strategies, additional data that may be important, considers role</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a><span class="co">#           of extent/resolution in analysis. </span></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a><span class="co"># 13. SELF-ASSESSMENT: How well does the project demonstrate that I achieved my</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a><span class="co">#       initial objects?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: Load libraries, instruct to cache</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="do">###??? R is not storing packages where I thought I told it to: "The downloaded </span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># binary packages are in </span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># C:\Users\kmhtd\AppData\Local\Temp\Rtmp2FbIVj\downloaded_packages""</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("broom", dependencies = TRUE)</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("caret", dependencies = TRUE)</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("car", dependencies = TRUE)</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("corrr", dependencies = TRUE)</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("educationdata", dependencies = TRUE)</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("forcats", dependencies = TRUE)</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("haven", dependencies = TRUE)</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("janitor", dependencies = TRUE)</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("KernSmooth", dependencies = TRUE)</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("lmtest", dependencies = TRUE)</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("purr", dependencies = TRUE)</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("spatstat", dependencies = TRUE)</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("spdep", dependencies = TRUE)</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("stargazer", dependencies = TRUE)</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("skimr", dependencies = TRUE)</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("sf", dependencies = TRUE)</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("styler", dependencies = TRUE)</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("terra", dependencies = TRUE)</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("tidycensus", dependencies = TRUE)</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("tidyverse", dependencies = TRUE)</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("tigris", dependencies = TRUE)</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("tmap", dependencies = TRUE)</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"broom"</span>)          <span class="do">## nice for inspecting objects</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"car"</span>)            <span class="do">## for multicollinearity/robust standard errors</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"caret"</span>)          <span class="do">## machine learning</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggplot2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lattice</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"corrr"</span>)          <span class="do">## nice for correlations</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"educationdata"</span>)  <span class="do">## to download CCD files from Urban Institute API</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"forcats"</span>)        <span class="do">## functions for cat vars</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"haven"</span>)          <span class="do">## to add labels</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"janitor"</span>)        <span class="do">## nice for crosstabs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'janitor'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    chisq.test, fisher.test</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"KernSmooth"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>KernSmooth 2.23 loaded
Copyright M. P. Wand 1997-2009</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"lmtest"</span>)         <span class="do">## for robust standard errors</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: zoo</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'zoo'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    as.Date, as.Date.numeric</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"purrr"</span>)          <span class="do">## streamlined mapping functions</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'purrr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:caret':

    lift</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:car':

    some</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"spatstat"</span>)       <span class="do">## for point data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: spatstat.data</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: spatstat.geom</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>spatstat.geom 3.2-9</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'spatstat.geom'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:car':

    ellipse</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: spatstat.random</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>spatstat.random 3.2-3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: spatstat.explore</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: nlme</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>spatstat.explore 3.2-7</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'spatstat.explore'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:lattice':

    panel.histogram</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: spatstat.model</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: rpart</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>spatstat.model 3.2-11</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'spatstat.model'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:lattice':

    panel.histogram</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:car':

    bc</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: spatstat.linnet</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>spatstat.linnet 3.1-5</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
spatstat 3.0-8 
For an introduction to spatstat, type 'beginner' </code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"spdep"</span>)          <span class="do">## for Moran's I</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: spData</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>To access larger datasets in this package, install the spDataLarge
package with: `install.packages('spDataLarge',
repos='https://nowosad.github.io/drat/', type='source')`</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: sf</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Linking to GEOS 3.11.2, GDAL 3.8.2, PROJ 9.3.1; sf_use_s2() is TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"sf"</span>)     </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"skimr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'skimr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:corrr':

    focus</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"spatstat"</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"stargazer"</span>)      <span class="do">## for producing polished tables</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Please cite as: </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> Hlavac, Marek (2022). stargazer: Well-Formatted Regression and Summary Statistics Tables.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> R package version 5.2.3. https://CRAN.R-project.org/package=stargazer </code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"styler"</span>)         <span class="do">## for applying tidyverse style to code</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"tidycensus"</span>)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"tidyverse"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ stringr   1.5.1
✔ lubridate 1.9.3     ✔ tibble    3.2.1
✔ readr     2.1.5     ✔ tidyr     1.3.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::collapse() masks nlme::collapse()
✖ dplyr::filter()   masks stats::filter()
✖ dplyr::lag()      masks stats::lag()
✖ purrr::lift()     masks caret::lift()
✖ dplyr::recode()   masks car::recode()
✖ purrr::some()     masks car::some()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"tigris"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>To enable caching of data, set `options(tigris_use_cache = TRUE)`
in your R script or .Rprofile.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span> (<span class="st">"tmap"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Breaking News: tmap 3.x is retiring. Please test v4, e.g. with
remotes::install_github('r-tmap/tmap')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="do">###???library_of_interest   ## Canche, p. 100</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">tigris_use_cache =</span> <span class="cn">TRUE</span>)  <span class="do">## Stores data for faster access</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="do">##### Per census documentation for 2013 and 2014, both 2013 and 2014 TIGER/Line</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="do">### Shapefiles reflect boundaries of governmental units as of 1/1/2013, with </span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   only minimal updates in 2014 due to suspension of data collection fm </span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   Boundary and Annexation survey that year. In addition, the 2012-13SY</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   appears to have been skipped, with the 2013 data reflecting school district </span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   boundaries for the 2011-12SY and the 2014 data reflecting 2013-14 boundaries.</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   www2.census.gov/geo/pdfs/maps-data/data/tiger/tgrshp2013/TGRSHP2013_TechDoc.pdf</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   www2.census.gov/geo/pdfs/maps-data/data/tiger/tgrshp2014/TGRSHP2014_TechDoc.pdf</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   B/c HSLS student in my sample graduated b/4 9/2013, I will use the boundaries</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   based on the 2011-12SY. These were updated in the 2010 census and descriptive</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   analysis of HSLS school locale data suggest most changes in locale </span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   categorization show up in the 2011-12SY data.</span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a><span class="do">##### Set Census API key</span></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a><span class="do">### DONE: census_api_key("382d5d70eb12317f39a66ee1ea697d15968c1689", install = TRUE)</span></span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a><span class="do">##### Download county shapefile w/ tigris - use cb = false for more accurate  </span></span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a><span class="do">###  mapping of water boundaries. Later use erase_water()</span></span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>counties_sf <span class="ot">&lt;-</span> <span class="fu">counties</span>(<span class="at">state =</span> <span class="cn">NULL</span>, </span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>                        <span class="at">cb =</span> <span class="cn">FALSE</span>, </span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resolution =</span> <span class="st">"500k"</span>, </span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>                        <span class="at">year =</span> <span class="dv">2013</span>)</span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(counties_sf))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="HS-Opp-Structures_files/figure-html/Download%20Census%20sf,%20then%20attribute%20dataframes%20-%20save%20to%20load%20into%20VCE-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(counties_sf)  <span class="do">## NAD83</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: NAD83 
  wkt:
GEOGCRS["NAD83",
    DATUM["North American Datum 1983",
        ELLIPSOID["GRS 1980",6378137,298.257222101,
            LENGTHUNIT["metre",1]]],
    PRIMEM["Greenwich",0,
        ANGLEUNIT["degree",0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS["latitude",north,
            ORDER[1],
            ANGLEUNIT["degree",0.0174532925199433]],
        AXIS["longitude",east,
            ORDER[2],
            ANGLEUNIT["degree",0.0174532925199433]],
    ID["EPSG",4269]]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(counties_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "sf"         "data.frame"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(counties_sf, <span class="st">"counties_sf.rds"</span>)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="do">##### ACS 5yr more robust than SAIPE and 1yr data - increased statistical </span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="do">###  reliability and better fit for pops with fewer than 20K residents</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="co">#    Dillingham et al. (2020). DESIGNED TO PROVIDE ESTIMATES OF POP, NOT </span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="co">#    COUNTS OF THE POP. IF DECIDE ON TRACT-LEVEL DATA, “ACS data for small </span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a><span class="co">#    statistical areas (such as census tracts) have no control totals, which may </span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a><span class="co">#    lead to errors in the population and housing unit estimates. In such cases, </span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a><span class="co">#    data users are encouraged to rely more upon noncount statistics, such as </span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a><span class="co">#    percent distributions or averages.” (p. 6)</span></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a><span class="do">##### Race data</span></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>counties_race <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(<span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>                         <span class="at">table =</span> (<span class="st">"B02001"</span>),</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>                         <span class="at">year =</span> <span class="dv">2013</span>,</span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>                         <span class="at">survey =</span> <span class="st">"acs5"</span>,</span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2009-2013 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading ACS5 variables for 2013 from table B02001. To cache this dataset for faster access to ACS tables in the future, run this function with `cache_table = TRUE`. You only need to do this once per ACS dataset.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(counties_race)  <span class="do">## long format</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  GEOID NAME                    variable   estimate   moe
  &lt;chr&gt; &lt;chr&gt;                   &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt;
1 01001 Autauga County, Alabama B02001_001    54907    NA
2 01001 Autauga County, Alabama B02001_002    42997   283
3 01001 Autauga County, Alabama B02001_003    10076   187
4 01001 Autauga County, Alabama B02001_004      138    66
5 01001 Autauga County, Alabama B02001_005      525   102
6 01001 Autauga County, Alabama B02001_006       15    25</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(counties_race, <span class="st">"counties_race.rds"</span>)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="do">##### Median income data. Per Thiede et al (2020, 2022), income data must be</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="do">### binned when using ACS summary files. Per Census staff recommendation, use</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   Supplemental Table 1901. </span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>counties_medinc <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(<span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>                             <span class="at">variables =</span> <span class="fu">c</span>(</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"S1901_C01_001"</span>, <span class="st">"S1901_C01_002"</span>, <span class="st">"S1901_C01_003"</span>,</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"S1901_C01_004"</span>, <span class="st">"S1901_C01_005"</span>, <span class="st">"S1901_C01_006"</span>,</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"S1901_C01_007"</span>, <span class="st">"S1901_C01_008"</span>, <span class="st">"S1901_C01_009"</span>,</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"S1901_C01_010"</span>, <span class="st">"S1901_C01_011"</span>), </span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>                             <span class="at">year =</span> <span class="dv">2013</span>,</span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>                             <span class="at">survey =</span> <span class="st">"acs5"</span>, </span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2009-2013 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Using the ACS Subject Tables</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(counties_medinc, <span class="st">"counties_medinc.rds"</span>)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="do">##### Poverty data. Census staff recommendation to use S1701.</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>counties_poverty <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(<span class="at">geography =</span> <span class="st">"county"</span>, </span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">variables =</span> <span class="fu">c</span>(</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"S1701_C01_001"</span>, <span class="st">"S1701_C01_002"</span>, </span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"S1701_C01_004"</span>, <span class="st">"S1701_C01_005"</span>),</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>                              <span class="at">year =</span> <span class="dv">2013</span>,</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>                              <span class="at">survey =</span> <span class="st">"acs5"</span>,</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2009-2013 5-year ACS
Using the ACS Subject Tables</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(counties_poverty, <span class="st">"counties_poverty.rds"</span>)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="do">##### Median IPR data.</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>counties_IPR <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(<span class="at">geography =</span> <span class="st">"county"</span>, </span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">variables =</span> <span class="fu">c</span>(</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"C17002_001"</span>, <span class="st">"C17002_002"</span>, </span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"C17002_003"</span>, <span class="st">"C17002_004"</span>, </span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"C17002_005"</span>, <span class="st">"C17002_006"</span>, </span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"C17002_007"</span>, <span class="st">"C17002_008"</span>), </span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">year =</span> <span class="dv">2013</span>,</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>                          <span class="at">survey =</span> <span class="st">"acs5"</span>,</span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2009-2013 5-year ACS</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(counties_IPR, <span class="st">"counties_IPR.rds"</span>)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="do">##### Educational attainment data.</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>counties_ed <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(<span class="at">geography =</span> <span class="st">"county"</span>, </span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">variables =</span> <span class="fu">c</span>(</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"DP02_0058"</span>, <span class="st">"DP02_0059"</span>, <span class="st">"DP02_0060"</span>,</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"DP02_0061"</span>, <span class="st">"DP02_0062"</span>, <span class="st">"DP02_0063"</span>,</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"DP02_0064"</span>, <span class="st">"DP02_0065"</span>),</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">year =</span> <span class="dv">2013</span>,</span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">survey =</span> <span class="st">"acs5"</span>,</span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2009-2013 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Using the ACS Data Profile</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(counties_ed, <span class="st">"counties_medinc.rds"</span>)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="do">##### Industry data. Grouping per Brown &amp; Schafft (2019). Pub Admin as ref group,</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="do">###  per Thiede et al. (2022) and Butler et al. (2020)</span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>counties_industry <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(<span class="at">geography =</span> <span class="st">"county"</span>, </span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>                           <span class="at">variables =</span> <span class="fu">c</span>(</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"S2405_C01_001"</span>, <span class="st">"S2405_C01_002"</span>, <span class="st">"S2405_C01_003"</span>,</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"S2405_C01_004"</span>, <span class="st">"S2405_C01_005"</span>, <span class="st">"S2405_C01_006"</span>,</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"S2405_C01_007"</span>, <span class="st">"S2405_C01_008"</span>, <span class="st">"S2405_C01_009"</span>,</span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"S2405_C01_010"</span>, <span class="st">"S2405_C01_011"</span>, <span class="st">"S2405_C01_012"</span>,</span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"S2405_C01_013"</span>, <span class="st">"S2405_C01_014"</span>),</span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a>                           <span class="at">year =</span> <span class="dv">2013</span>,</span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a>                           <span class="at">survey =</span> <span class="st">"acs5"</span>,</span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2009-2013 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Using the ACS Subject Tables</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(counties_industry, <span class="st">"counties_industry.rds"</span>)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="do">##### Unemployment data.</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>counties_unemploy <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(<span class="at">geography =</span> <span class="st">"county"</span>, </span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">variables =</span> <span class="fu">c</span>(</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"DP03_0003"</span>, <span class="st">"DP03_0004"</span>, <span class="st">"DP03_0005"</span>),</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>                              <span class="at">year =</span> <span class="dv">2013</span>,</span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>                              <span class="at">survey =</span> <span class="st">"acs5"</span>,</span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2009-2013 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Using the ACS Data Profile</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(counties_unemploy, <span class="st">"counties_unemploy.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="do">##### Load school-level dataframes from Urban Institute Ed Portal, 2009/10 </span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="do">###  thru 2012/13 SYs - Only public schools included. Directory file needed</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="do">##   for extended locale variable. </span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="do">### 2009-10 SY</span></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>CCD2009_dir <span class="ot">&lt;-</span> <span class="fu">get_education_data</span>(<span class="at">level =</span> <span class="st">"schools"</span>,</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">source =</span> <span class="st">"ccd"</span>,</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">topic =</span> <span class="st">"directory"</span>,</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">filters =</span> <span class="fu">list</span>(<span class="at">year =</span> <span class="dv">2009</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Fetching data for schools/ccd/directory/2009/? ...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Processing page 2 out of 11</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Processing page 3 out of 11</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Processing page 4 out of 11</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Processing page 5 out of 11</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Processing page 6 out of 11</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Processing page 7 out of 11</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Processing page 8 out of 11</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Processing page 9 out of 11</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Processing page 10 out of 11</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Processing page 11 out of 11</code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(CCD2009_dir, <span class="st">"CCD2009_dir.rds"</span>)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(CCD2009_dir)  <span class="do">## wide format</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  year      ncessch school_id                      school_name   leaid
1 2009 010000200277     00277 SEQUOYAH SCH - CHALKVILLE CAMPUS 0100002
2 2009 010000201402     01402     EUFAULA SCH - EUFAULA CAMPUS 0100002
3 2009 010000201667     01667                            CAMPS 0100002
4 2009 010000201670     01670                          DET CTR 0100002
5 2009 010000201705     01705    WALLACE SCH - MT MEIGS CAMPUS 0100002
6 2009 010000201706     01706        MCNEEL SCH - VACCA CAMPUS 0100002
                lea_name state_leaid seasch    street_mailing city_mailing
1 ALABAMA YOUTH SERVICES         210   0020      P O BOX 9486   BIRMINGHAM
2 ALABAMA YOUTH SERVICES         210   0025  315 OUTBACK ROAD      CLAYTON
3 ALABAMA YOUTH SERVICES         210   0050        P O BOX 66     MT MEIGS
4 ALABAMA YOUTH SERVICES         210   0060        P O BOX 66     MT MEIGS
5 ALABAMA YOUTH SERVICES         210   0030        P O BOX 66  MOUNT MEIGS
6 ALABAMA YOUTH SERVICES         210   0040 8950 ROEBUCK BLVD   BIRMINGHAM
  state_mailing zip_mailing         street_location city_location
1            AL       35220 RT 2 OLD SPRINGVILLE RD        PINSON
2            AL       36016          315 OUTBACK RD       CLAYTON
3            AL       36057                      -1      MT MEIGS
4            AL       36057                      -1      MT MEIGS
5            AL       36057          I85 SERVICE RD   MOUNT MEIGS
6            AL       35206       8950 ROEBUCK BLVD    BIRMINGHAM
  state_location zip_location      phone fips latitude longitude csa cbsa
1             AL        36126 2056808574    1 33.69913 -86.60667  NA   NA
2             AL        36016 3346874441    1 31.87947 -85.24708  NA   NA
3             AL        36057 3342153850    1 32.38782 -86.10074  NA   NA
4             AL        36057 3342153850    1 32.38774 -86.10048  NA   NA
5             AL        36057 3342156039    1 32.37876 -86.08316  NA   NA
6             AL        35206 2058384981    1 33.58215 -86.71110  NA   NA
  urban_centric_locale county_code school_level school_type school_status
1                   41        1073            3           4             1
2                   42        1005            4           4             1
3                   41        1101            3           4             1
4                   41        1101            3           4             1
5                   41        1101            3           4             1
6                   12        1073            3           4             1
  lowest_grade_offered highest_grade_offered bureau_indian_education
1                    7                    12                       0
2                    3                    12                       0
3                    7                    12                       0
4                    7                    12                       0
5                    7                    12                       0
6                    7                    12                       0
  title_i_status title_i_eligible title_i_schoolwide charter magnet shared_time
1             NA               -2                 -2      -2     -1          -1
2             NA               -2                 -2      -2     -1          -1
3             NA               -2                 -2      -2     -1          -1
4             NA               -2                 -2      -2     -1          -1
5             NA               -2                 -2      -2     -1          -1
6             NA               -2                 -2      -2     -1          -1
  virtual teachers_fte free_lunch reduced_price_lunch
1      NA            0         -2                  -2
2      NA            0         -2                  -2
3      NA            0         -2                  -2
4      NA            0         -2                  -2
5      NA            0         -2                  -2
6      NA            0         -2                  -2
  free_or_reduced_price_lunch elem_cedp high_cedp middle_cedp ungrade_cedp
1                          -2         0         1           1            0
2                          -2         1         1           1            0
3                          -2         0         1           1            0
4                          -2         0         1           1            0
5                          -2         0         1           1            0
6                          -2         0         1           1            0
  enrollment state_leg_district_lower state_leg_district_upper ncessch_num
1          0                                                   10000200277
2          0                                                   10000201402
3          0                                                   10000201667
4          0                                                   10000201670
5          0                                                   10000201705
6          0                                                   10000201706
  congress_district_id direct_certification lunch_program
1                   NA                   NA            NA
2                   NA                   NA            NA
3                   NA                   NA            NA
4                   NA                   NA            NA
5                   NA                   NA            NA
6                   NA                   NA            NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="do">### 2010-11 SY</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>CCD2010_dir <span class="ot">&lt;-</span> <span class="fu">get_education_data</span>(<span class="at">level =</span> <span class="st">"schools"</span>,</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">source =</span> <span class="st">"ccd"</span>,</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">topic =</span> <span class="st">"directory"</span>,</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">filters =</span> <span class="fu">list</span>(<span class="at">year =</span> <span class="dv">2010</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Fetching data for schools/ccd/directory/2010/? ...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Processing page 2 out of 11</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Processing page 3 out of 11</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Processing page 4 out of 11</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Processing page 5 out of 11</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Processing page 6 out of 11</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Processing page 7 out of 11</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Processing page 8 out of 11</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Processing page 9 out of 11</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Processing page 10 out of 11</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Processing page 11 out of 11</code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(CCD2010_dir, <span class="st">"CCD2010_dir.rds"</span>)</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a><span class="do">### 2011-12SY</span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>CCD2011_dir <span class="ot">&lt;-</span> <span class="fu">get_education_data</span>(<span class="at">level =</span> <span class="st">"schools"</span>,</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">source =</span> <span class="st">"ccd"</span>,</span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">topic =</span> <span class="st">"directory"</span>,</span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">filters =</span> <span class="fu">list</span>(<span class="at">year =</span> <span class="dv">2011</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Fetching data for schools/ccd/directory/2011/? ...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Processing page 2 out of 11</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Processing page 3 out of 11</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Processing page 4 out of 11</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Processing page 5 out of 11</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Processing page 6 out of 11</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Processing page 7 out of 11</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Processing page 8 out of 11</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Processing page 9 out of 11</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Processing page 10 out of 11</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Processing page 11 out of 11</code></pre>
</div>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(CCD2011_dir, <span class="st">"CCD2011_dir.rds"</span>)</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(CCD2011_dir)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  year      ncessch school_id                      school_name   leaid
1 2011 010000200277     00277 SEQUOYAH SCH - CHALKVILLE CAMPUS 0100002
2 2011 010000201402     01402     EUFAULA SCH - EUFAULA CAMPUS 0100002
3 2011 010000201667     01667                            CAMPS 0100002
4 2011 010000201670     01670                          DET CTR 0100002
5 2011 010000201705     01705    WALLACE SCH - MT MEIGS CAMPUS 0100002
6 2011 010000201706     01706        MCNEEL SCH - VACCA CAMPUS 0100002
                lea_name state_leaid seasch    street_mailing city_mailing
1 ALABAMA YOUTH SERVICES         210   0020      P O BOX 9486   BIRMINGHAM
2 ALABAMA YOUTH SERVICES         210   0025  315 OUTBACK ROAD      CLAYTON
3 ALABAMA YOUTH SERVICES         210   0050        P O BOX 66     MT MEIGS
4 ALABAMA YOUTH SERVICES         210   0060        P O BOX 66     MT MEIGS
5 ALABAMA YOUTH SERVICES         210   0030        P O BOX 66  MOUNT MEIGS
6 ALABAMA YOUTH SERVICES         210   0040 8950 ROEBUCK BLVD   BIRMINGHAM
  state_mailing zip_mailing         street_location city_location
1            AL       35220 RT 2 OLD SPRINGVILLE RD        PINSON
2            AL       36016          315 OUTBACK RD       CLAYTON
3            AL       36057    INDUSTRIAL SCHOOL RD      MT MEIGS
4            AL       36057    INDUSTRIAL SCHOOL RD      MT MEIGS
5            AL       36057          I85 SERVICE RD   MOUNT MEIGS
6            AL       35206       8950 ROEBUCK BLVD    BIRMINGHAM
  state_location zip_location      phone fips latitude longitude csa cbsa
1             AL        36126 2056808574    1 33.69913 -86.60667  NA   NA
2             AL        36016 3346874441    1 31.88157 -85.25276  NA   NA
3             AL        36057 3342153850    1 32.38782 -86.10074  NA   NA
4             AL        36057 3342153850    1 32.38774 -86.10048  NA   NA
5             AL        36057 3342156039    1 32.37876 -86.08316  NA   NA
6             AL        35206 2058384981    1 33.58671 -86.71058  NA   NA
  urban_centric_locale county_code school_level school_type school_status
1                   41        1073            3           4             1
2                   42        1005            4           4             1
3                   41        1101            3           4             1
4                   41        1101            3           4             1
5                   41        1101            3           4             1
6                   12        1073            3           4             1
  lowest_grade_offered highest_grade_offered bureau_indian_education
1                    7                    12                       0
2                    3                    12                       0
3                    7                    12                       0
4                    7                    12                       0
5                    7                    12                       0
6                    7                    12                       0
  title_i_status title_i_eligible title_i_schoolwide charter magnet shared_time
1             -2               -2                 -2      -2      0           0
2             -2               -2                 -2      -2      0           0
3             -2               -2                 -2      -2      0           0
4             -2               -2                 -2      -2      0           0
5             -2               -2                 -2      -2      0           0
6             -2               -2                 -2      -2      0           0
  virtual teachers_fte free_lunch reduced_price_lunch
1      NA            0         -2                  -2
2      NA            0         -2                  -2
3      NA            0         -2                  -2
4      NA            0         -2                  -2
5      NA            0         -2                  -2
6      NA            0         -2                  -2
  free_or_reduced_price_lunch elem_cedp high_cedp middle_cedp ungrade_cedp
1                          -2         0         1           1            0
2                          -2         1         1           1            0
3                          -2         0         1           1            0
4                          -2         0         1           1            0
5                          -2         0         1           1            0
6                          -2         0         1           1            0
  enrollment state_leg_district_lower state_leg_district_upper ncessch_num
1          0                                                   10000200277
2          0                                                   10000201402
3          0                                                   10000201667
4          0                                                   10000201670
5          0                                                   10000201705
6          0                                                   10000201706
  congress_district_id direct_certification lunch_program
1                   NA                   NA            NA
2                   NA                   NA            NA
3                   NA                   NA            NA
4                   NA                   NA            NA
5                   NA                   NA            NA
6                   NA                   NA            NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="do">### 2012-13 SY</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>CCD2012_dir <span class="ot">&lt;-</span> <span class="fu">get_education_data</span>(<span class="at">level =</span> <span class="st">"schools"</span>,</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">source =</span> <span class="st">"ccd"</span>,</span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">topic =</span> <span class="st">"directory"</span>,</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">filters =</span> <span class="fu">list</span>(<span class="at">year =</span> <span class="dv">2012</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Fetching data for schools/ccd/directory/2012/? ...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Processing page 2 out of 11</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Processing page 3 out of 11</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Processing page 4 out of 11</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Processing page 5 out of 11</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Processing page 6 out of 11</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Processing page 7 out of 11</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Processing page 8 out of 11</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Processing page 9 out of 11</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Processing page 10 out of 11</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Processing page 11 out of 11</code></pre>
</div>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(CCD2012_dir, <span class="st">"CCD2012_dir.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Rename variables so understandable</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>counties_race <span class="ot">&lt;-</span> counties_race <span class="sc">%&gt;%</span></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">variable  =</span> <span class="fu">case_when</span>(</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"B02001_001"</span> <span class="sc">~</span> <span class="st">"race_total"</span>,</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"B02001_002"</span> <span class="sc">~</span> <span class="st">"White"</span>,</span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"B02001_003"</span> <span class="sc">~</span> <span class="st">"Black"</span>,</span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"B02001_004"</span> <span class="sc">~</span> <span class="st">"AmIn_AlNat"</span>,</span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"B02001_005"</span> <span class="sc">~</span> <span class="st">"As"</span>,</span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"B02001_006"</span> <span class="sc">~</span> <span class="st">"NatHaw_OPI"</span>,</span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"B02001_007"</span> <span class="sc">~</span> <span class="st">"Oth"</span>,</span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"B02001_008"</span> <span class="sc">~</span> <span class="st">"Two_More"</span>,</span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"B02001_009"</span> <span class="sc">~</span> <span class="st">"Two_InclSome"</span>,</span>
<span id="cb143-13"><a href="#cb143-13" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"B02001_010"</span> <span class="sc">~</span> <span class="st">"Two_InclSome_More"</span></span>
<span id="cb143-14"><a href="#cb143-14" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb143-15"><a href="#cb143-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-16"><a href="#cb143-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Pivot from long to wide</span></span>
<span id="cb143-17"><a href="#cb143-17" aria-hidden="true" tabindex="-1"></a>counties_race_wide <span class="ot">&lt;-</span> counties_race <span class="sc">%&gt;%</span></span>
<span id="cb143-18"><a href="#cb143-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb143-19"><a href="#cb143-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> variable,</span>
<span id="cb143-20"><a href="#cb143-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> <span class="fu">c</span>(estimate, moe))</span>
<span id="cb143-21"><a href="#cb143-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-22"><a href="#cb143-22" aria-hidden="true" tabindex="-1"></a><span class="do">## Low n's - combine other/multi categories, keep only needed</span></span>
<span id="cb143-23"><a href="#cb143-23" aria-hidden="true" tabindex="-1"></a>counties_race_wide <span class="ot">&lt;-</span> counties_race_wide <span class="sc">%&gt;%</span></span>
<span id="cb143-24"><a href="#cb143-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb143-25"><a href="#cb143-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate_Other_Some =</span> estimate_Oth <span class="sc">+</span> estimate_Two_More, </span>
<span id="cb143-26"><a href="#cb143-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">moe_Other_Some =</span> moe_Oth <span class="sc">+</span> moe_Two_More</span>
<span id="cb143-27"><a href="#cb143-27" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb143-28"><a href="#cb143-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-29"><a href="#cb143-29" aria-hidden="true" tabindex="-1"></a>counties_race_wide <span class="ot">&lt;-</span> counties_race_wide <span class="sc">%&gt;%</span></span>
<span id="cb143-30"><a href="#cb143-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>estimate_Oth, <span class="sc">-</span>estimate_Two_More, <span class="sc">-</span>estimate_Two_InclSome,</span>
<span id="cb143-31"><a href="#cb143-31" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span>estimate_Two_InclSome_More, <span class="sc">-</span>moe_Oth, <span class="sc">-</span>moe_Two_More,  </span>
<span id="cb143-32"><a href="#cb143-32" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span>moe_Two_InclSome, <span class="sc">-</span>moe_Two_InclSome_More)</span>
<span id="cb143-33"><a href="#cb143-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-34"><a href="#cb143-34" aria-hidden="true" tabindex="-1"></a><span class="do">## Check sums</span></span>
<span id="cb143-35"><a href="#cb143-35" aria-hidden="true" tabindex="-1"></a>counties_race_wide <span class="ot">&lt;-</span> counties_race_wide <span class="sc">%&gt;%</span></span>
<span id="cb143-36"><a href="#cb143-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb143-37"><a href="#cb143-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">check_race_sums =</span> estimate_White <span class="sc">+</span> estimate_Black <span class="sc">+</span> estimate_AmIn_AlNat <span class="sc">+</span></span>
<span id="cb143-38"><a href="#cb143-38" aria-hidden="true" tabindex="-1"></a>                        estimate_As <span class="sc">+</span> estimate_NatHaw_OPI <span class="sc">+</span> estimate_Other_Some</span>
<span id="cb143-39"><a href="#cb143-39" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb143-40"><a href="#cb143-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-41"><a href="#cb143-41" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(counties_race_wide<span class="sc">$</span>check_race_sums)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
     71   11252   25975   97864   66015 9893481 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>counties_race_wide <span class="ot">&lt;-</span> counties_race_wide <span class="sc">%&gt;%</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">check_race_diff =</span> <span class="fu">ifelse</span>(estimate_race_total <span class="sc">!=</span> check_race_sums, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(counties_race_wide<span class="sc">$</span>check_race_diff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
      0       0       0       0       0       0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="do">## No sums differ from totals - drop check vars</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>counties_race_wide <span class="ot">&lt;-</span> counties_race_wide <span class="sc">%&gt;%</span></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span><span class="fu">c</span>(check_race_sums, check_race_diff))</span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Reorder vars</span></span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a>counties_race_wide <span class="ot">&lt;-</span> counties_race_wide <span class="sc">%&gt;%</span> </span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(estimate_Other_Some, <span class="at">.before =</span> moe_race_total)</span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-9"><a href="#cb147-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Drop outlying areas</span></span>
<span id="cb147-10"><a href="#cb147-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out rows where the first two digits of GEOID are greater than 56</span></span>
<span id="cb147-11"><a href="#cb147-11" aria-hidden="true" tabindex="-1"></a>counties_race_wide  <span class="ot">&lt;-</span> counties_race_wide <span class="sc">%&gt;%</span></span>
<span id="cb147-12"><a href="#cb147-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">as.numeric</span>(<span class="fu">substr</span>(GEOID, <span class="dv">1</span>, <span class="dv">2</span>)) <span class="sc">&lt;=</span> <span class="dv">56</span>)</span>
<span id="cb147-13"><a href="#cb147-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-14"><a href="#cb147-14" aria-hidden="true" tabindex="-1"></a>check_race_states <span class="ot">&lt;-</span> counties_race_wide <span class="sc">%&gt;%</span></span>
<span id="cb147-15"><a href="#cb147-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">as.numeric</span>(<span class="fu">substr</span>(GEOID, <span class="dv">1</span>, <span class="dv">2</span>)) <span class="sc">&gt;</span> <span class="dv">56</span>)</span>
<span id="cb147-16"><a href="#cb147-16" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(check_race_states)  <span class="do">## 0 obs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt; table of extent 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 &gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(counties_race_wide, <span class="st">"counties_race_wide.rds"</span>)</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Run basic descriptives </span></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(counties_race_wide)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">counties_race_wide</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">3143</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">16</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">14</td>
</tr>
<tr class="even">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">GEOID</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3143</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">NAME</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3143</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 2%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">estimate_race_total</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">99120.77</td>
<td style="text-align: right;">316491.40</td>
<td style="text-align: right;">71</td>
<td style="text-align: right;">11054.0</td>
<td style="text-align: right;">25815</td>
<td style="text-align: right;">67086.50</td>
<td style="text-align: right;">9893481</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">estimate_White</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">73367.03</td>
<td style="text-align: right;">198888.76</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">9205.5</td>
<td style="text-align: right;">22042</td>
<td style="text-align: right;">57048.00</td>
<td style="text-align: right;">5277461</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">estimate_Black</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">12461.66</td>
<td style="text-align: right;">54400.81</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">87.0</td>
<td style="text-align: right;">742</td>
<td style="text-align: right;">5500.00</td>
<td style="text-align: right;">1272312</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">estimate_AmIn_AlNat</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">808.24</td>
<td style="text-align: right;">3277.81</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">28.0</td>
<td style="text-align: right;">105</td>
<td style="text-align: right;">433.00</td>
<td style="text-align: right;">72913</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">estimate_As</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">4846.31</td>
<td style="text-align: right;">36874.98</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">26.0</td>
<td style="text-align: right;">122</td>
<td style="text-align: right;">673.50</td>
<td style="text-align: right;">1372726</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">estimate_NatHaw_OPI</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">167.47</td>
<td style="text-align: right;">1910.66</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">28.00</td>
<td style="text-align: right;">89035</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">estimate_Other_Some</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">7470.06</td>
<td style="text-align: right;">52042.81</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">234.5</td>
<td style="text-align: right;">710</td>
<td style="text-align: right;">2660.00</td>
<td style="text-align: right;">2331836</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">moe_race_total</td>
<td style="text-align: right;">3039</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">122.24</td>
<td style="text-align: right;">54.10</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">91.0</td>
<td style="text-align: right;">116</td>
<td style="text-align: right;">132.75</td>
<td style="text-align: right;">396</td>
<td style="text-align: left;">▃▇▂▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">moe_White</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">395.38</td>
<td style="text-align: right;">815.18</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">69.0</td>
<td style="text-align: right;">156</td>
<td style="text-align: right;">394.50</td>
<td style="text-align: right;">20050</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">moe_Black</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">208.47</td>
<td style="text-align: right;">315.47</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">40.0</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">230.00</td>
<td style="text-align: right;">3333</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">moe_AmIn_AlNat</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">118.02</td>
<td style="text-align: right;">170.50</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">26.0</td>
<td style="text-align: right;">61</td>
<td style="text-align: right;">138.00</td>
<td style="text-align: right;">2402</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">moe_As</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">119.66</td>
<td style="text-align: right;">225.21</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">19.0</td>
<td style="text-align: right;">47</td>
<td style="text-align: right;">118.00</td>
<td style="text-align: right;">3435</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">moe_NatHaw_OPI</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">40.33</td>
<td style="text-align: right;">75.30</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">15.0</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">32.00</td>
<td style="text-align: right;">1789</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">moe_Other_Some</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">646.63</td>
<td style="text-align: right;">1228.38</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">122.0</td>
<td style="text-align: right;">277</td>
<td style="text-align: right;">649.00</td>
<td style="text-align: right;">29518</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="do">###??? Not sure what I do w/ moe</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Rename variables so understandable</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>counties_medinc <span class="ot">&lt;-</span> counties_medinc <span class="sc">%&gt;%</span> </span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">variable  =</span> <span class="fu">case_when</span>(</span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"S1901_C01_001"</span> <span class="sc">~</span> <span class="st">"medinc_total"</span>,</span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"S1901_C01_002"</span> <span class="sc">~</span> <span class="st">"medinc_lt_10K"</span>,</span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"S1901_C01_003"</span> <span class="sc">~</span> <span class="st">"medinc_10_14K"</span>,</span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"S1901_C01_004"</span> <span class="sc">~</span> <span class="st">"medinc_15_24K"</span>,</span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"S1901_C01_005"</span> <span class="sc">~</span> <span class="st">"medinc_25_34K"</span>,</span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"S1901_C01_006"</span> <span class="sc">~</span> <span class="st">"medinc_35_49K"</span>,</span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"S1901_C01_007"</span> <span class="sc">~</span> <span class="st">"medinc_50_74K"</span>,</span>
<span id="cb151-11"><a href="#cb151-11" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"S1901_C01_008"</span> <span class="sc">~</span> <span class="st">"medinc_75_99K"</span>,</span>
<span id="cb151-12"><a href="#cb151-12" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"S1901_C01_009"</span> <span class="sc">~</span> <span class="st">"medinc_100_149K"</span>,</span>
<span id="cb151-13"><a href="#cb151-13" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"S1901_C01_010"</span> <span class="sc">~</span> <span class="st">"medinc_150_199K"</span>,</span>
<span id="cb151-14"><a href="#cb151-14" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"S1901_C01_011"</span> <span class="sc">~</span> <span class="st">"medinc_200Kplus"</span>,    </span>
<span id="cb151-15"><a href="#cb151-15" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb151-16"><a href="#cb151-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-17"><a href="#cb151-17" aria-hidden="true" tabindex="-1"></a><span class="do">## estimates are in percentages</span></span>
<span id="cb151-18"><a href="#cb151-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-19"><a href="#cb151-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Pivot from long to wide</span></span>
<span id="cb151-20"><a href="#cb151-20" aria-hidden="true" tabindex="-1"></a>counties_medinc_wide <span class="ot">&lt;-</span> counties_medinc <span class="sc">%&gt;%</span></span>
<span id="cb151-21"><a href="#cb151-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb151-22"><a href="#cb151-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> variable,</span>
<span id="cb151-23"><a href="#cb151-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> <span class="fu">c</span>(estimate, moe))</span>
<span id="cb151-24"><a href="#cb151-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-25"><a href="#cb151-25" aria-hidden="true" tabindex="-1"></a><span class="do">##### Collapse income bins. Thiede et al (2022), use bins of 25K but stop at </span></span>
<span id="cb151-26"><a href="#cb151-26" aria-hidden="true" tabindex="-1"></a><span class="do">###  50K+ - will bin to 100K+. In table S1901, estimates reported as pctgs.  </span></span>
<span id="cb151-27"><a href="#cb151-27" aria-hidden="true" tabindex="-1"></a><span class="co">#    Need to change in order to collapse categories. </span></span>
<span id="cb151-28"><a href="#cb151-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-29"><a href="#cb151-29" aria-hidden="true" tabindex="-1"></a><span class="do">## Move the decimal over two places</span></span>
<span id="cb151-30"><a href="#cb151-30" aria-hidden="true" tabindex="-1"></a>counties_medinc_wide <span class="ot">&lt;-</span> counties_medinc_wide <span class="sc">%&gt;%</span></span>
<span id="cb151-31"><a href="#cb151-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb151-32"><a href="#cb151-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">adj_est_medinc_lt_10K =</span> estimate_medinc_lt_10K <span class="sc">/</span> <span class="dv">100</span>,  </span>
<span id="cb151-33"><a href="#cb151-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">adj_est_medinc_10_14K =</span> estimate_medinc_10_14K <span class="sc">/</span> <span class="dv">100</span>,</span>
<span id="cb151-34"><a href="#cb151-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">adj_est_medinc_15_24K =</span> estimate_medinc_15_24K <span class="sc">/</span> <span class="dv">100</span>,</span>
<span id="cb151-35"><a href="#cb151-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">adj_est_medinc_25_34K =</span> estimate_medinc_25_34K <span class="sc">/</span> <span class="dv">100</span>,</span>
<span id="cb151-36"><a href="#cb151-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">adj_est_medinc_35_49K =</span> estimate_medinc_35_49K <span class="sc">/</span> <span class="dv">100</span>,</span>
<span id="cb151-37"><a href="#cb151-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">adj_est_medinc_50_74K =</span> estimate_medinc_50_74K <span class="sc">/</span> <span class="dv">100</span>,</span>
<span id="cb151-38"><a href="#cb151-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">adj_est_medinc_75_99K =</span> estimate_medinc_75_99K <span class="sc">/</span> <span class="dv">100</span>,</span>
<span id="cb151-39"><a href="#cb151-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">adj_est_medinc_100_149K =</span> estimate_medinc_100_149K <span class="sc">/</span> <span class="dv">100</span>,</span>
<span id="cb151-40"><a href="#cb151-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">adj_est_medinc_150_199K =</span> estimate_medinc_150_199K <span class="sc">/</span> <span class="dv">100</span>,</span>
<span id="cb151-41"><a href="#cb151-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">adj_est_medinc_200Kplus =</span> estimate_medinc_200Kplus <span class="sc">/</span> <span class="dv">100</span></span>
<span id="cb151-42"><a href="#cb151-42" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb151-43"><a href="#cb151-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-44"><a href="#cb151-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate counts</span></span>
<span id="cb151-45"><a href="#cb151-45" aria-hidden="true" tabindex="-1"></a>counties_medinc_wide <span class="ot">&lt;-</span> counties_medinc_wide <span class="sc">%&gt;%</span></span>
<span id="cb151-46"><a href="#cb151-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb151-47"><a href="#cb151-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">medinc_lt_10K_est_count =</span> adj_est_medinc_lt_10K <span class="sc">*</span> estimate_medinc_total,</span>
<span id="cb151-48"><a href="#cb151-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">medinc_10_14K_est_count =</span> adj_est_medinc_10_14K <span class="sc">*</span> estimate_medinc_total,</span>
<span id="cb151-49"><a href="#cb151-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">medinc_15_24K_est_count =</span> adj_est_medinc_15_24K <span class="sc">*</span> estimate_medinc_total,</span>
<span id="cb151-50"><a href="#cb151-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">medinc_25_34K_est_count =</span> adj_est_medinc_25_34K <span class="sc">*</span> estimate_medinc_total,</span>
<span id="cb151-51"><a href="#cb151-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">medinc_35_49K_est_count =</span> adj_est_medinc_35_49K <span class="sc">*</span> estimate_medinc_total,</span>
<span id="cb151-52"><a href="#cb151-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">medinc_50_74K_est_count =</span> adj_est_medinc_50_74K <span class="sc">*</span> estimate_medinc_total,</span>
<span id="cb151-53"><a href="#cb151-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">medinc_75_99K_est_count =</span> adj_est_medinc_75_99K <span class="sc">*</span> estimate_medinc_total,</span>
<span id="cb151-54"><a href="#cb151-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">medinc_100_149K_est_count =</span> adj_est_medinc_100_149K <span class="sc">*</span> estimate_medinc_total,</span>
<span id="cb151-55"><a href="#cb151-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">medinc_150_199K_est_count =</span> adj_est_medinc_150_199K <span class="sc">*</span> estimate_medinc_total,</span>
<span id="cb151-56"><a href="#cb151-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">medinc_200Kplus_est_count =</span> adj_est_medinc_200Kplus <span class="sc">*</span> estimate_medinc_total</span>
<span id="cb151-57"><a href="#cb151-57" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb151-58"><a href="#cb151-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-59"><a href="#cb151-59" aria-hidden="true" tabindex="-1"></a><span class="do">## Collapse to wider bins</span></span>
<span id="cb151-60"><a href="#cb151-60" aria-hidden="true" tabindex="-1"></a>counties_medinc_wide <span class="ot">&lt;-</span> counties_medinc_wide <span class="sc">%&gt;%</span></span>
<span id="cb151-61"><a href="#cb151-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( </span>
<span id="cb151-62"><a href="#cb151-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">medinc_lt25K_est_count =</span> medinc_lt_10K_est_count <span class="sc">+</span> </span>
<span id="cb151-63"><a href="#cb151-63" aria-hidden="true" tabindex="-1"></a>                             medinc_10_14K_est_count <span class="sc">+</span></span>
<span id="cb151-64"><a href="#cb151-64" aria-hidden="true" tabindex="-1"></a>                             medinc_15_24K_est_count,</span>
<span id="cb151-65"><a href="#cb151-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">medinc_25_49K_est_count =</span> medinc_25_34K_est_count <span class="sc">+</span></span>
<span id="cb151-66"><a href="#cb151-66" aria-hidden="true" tabindex="-1"></a>                              medinc_35_49K_est_count,</span>
<span id="cb151-67"><a href="#cb151-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">medinc_gt100K_est_count =</span> medinc_100_149K_est_count <span class="sc">+</span> </span>
<span id="cb151-68"><a href="#cb151-68" aria-hidden="true" tabindex="-1"></a>                              medinc_150_199K_est_count <span class="sc">+</span> </span>
<span id="cb151-69"><a href="#cb151-69" aria-hidden="true" tabindex="-1"></a>                              medinc_200Kplus_est_count)</span>
<span id="cb151-70"><a href="#cb151-70" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb151-71"><a href="#cb151-71" aria-hidden="true" tabindex="-1"></a><span class="do">## Check sums</span></span>
<span id="cb151-72"><a href="#cb151-72" aria-hidden="true" tabindex="-1"></a>counties_medinc_wide <span class="ot">&lt;-</span> counties_medinc_wide <span class="sc">%&gt;%</span></span>
<span id="cb151-73"><a href="#cb151-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb151-74"><a href="#cb151-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">check_medinc_sums =</span> medinc_lt25K_est_count <span class="sc">+</span></span>
<span id="cb151-75"><a href="#cb151-75" aria-hidden="true" tabindex="-1"></a>                        medinc_25_49K_est_count <span class="sc">+</span> </span>
<span id="cb151-76"><a href="#cb151-76" aria-hidden="true" tabindex="-1"></a>                        medinc_50_74K_est_count <span class="sc">+</span></span>
<span id="cb151-77"><a href="#cb151-77" aria-hidden="true" tabindex="-1"></a>                        medinc_75_99K_est_count <span class="sc">+</span></span>
<span id="cb151-78"><a href="#cb151-78" aria-hidden="true" tabindex="-1"></a>                        medinc_gt100K_est_count)</span>
<span id="cb151-79"><a href="#cb151-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-80"><a href="#cb151-80" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(counties_medinc_wide<span class="sc">$</span>check_medinc_sums)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
     33    4321    9828   36279   25052 3236844 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>counties_medinc_wide <span class="ot">&lt;-</span> counties_medinc_wide <span class="sc">%&gt;%</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">check_medinc_diff =</span> <span class="fu">ifelse</span>(estimate_medinc_total <span class="sc">!=</span> check_medinc_sums, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(counties_medinc_wide<span class="sc">$</span>check_medinc_diff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.0000  0.0000  1.0000  0.6607  1.0000  1.0000 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop outlying areas</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>counties_medinc_wide  <span class="ot">&lt;-</span> counties_medinc_wide <span class="sc">%&gt;%</span></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">as.numeric</span>(<span class="fu">substr</span>(GEOID, <span class="dv">1</span>, <span class="dv">2</span>)) <span class="sc">&lt;=</span> <span class="dv">56</span>)</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>check_medinc_states <span class="ot">&lt;-</span> counties_medinc_wide <span class="sc">%&gt;%</span></span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">as.numeric</span>(<span class="fu">substr</span>(GEOID, <span class="dv">1</span>, <span class="dv">2</span>)) <span class="sc">&gt;</span> <span class="dv">56</span>)</span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(check_medinc_states)  <span class="do">## 0 obs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt; table of extent 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 &gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(counties_medinc_wide, <span class="st">"counties_medinc_wide.rds"</span>)</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Run basic descriptives </span></span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(counties_medinc_wide, GEOID<span class="sc">:</span>estimate_medinc_200Kplus) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">counties_medinc_wide</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">3143</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">49</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">11</td>
</tr>
<tr class="even">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">GEOID</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3143</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">NAME</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3143</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 22%">
<col style="width: 9%">
<col style="width: 12%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 4%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">estimate_medinc_total</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">36783.40</td>
<td style="text-align: right;">111176.62</td>
<td style="text-align: right;">33.0</td>
<td style="text-align: right;">4230.5</td>
<td style="text-align: right;">9781.0</td>
<td style="text-align: right;">25675.5</td>
<td style="text-align: right;">3230383.0</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">estimate_medinc_lt_10K</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8.32</td>
<td style="text-align: right;">3.73</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">5.7</td>
<td style="text-align: right;">7.6</td>
<td style="text-align: right;">10.1</td>
<td style="text-align: right;">28.1</td>
<td style="text-align: left;">▃▇▂▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">estimate_medinc_10_14K</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6.71</td>
<td style="text-align: right;">2.37</td>
<td style="text-align: right;">0.3</td>
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">6.5</td>
<td style="text-align: right;">8.1</td>
<td style="text-align: right;">22.0</td>
<td style="text-align: left;">▂▇▂▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">estimate_medinc_15_24K</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">12.95</td>
<td style="text-align: right;">3.37</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">10.7</td>
<td style="text-align: right;">13.0</td>
<td style="text-align: right;">15.1</td>
<td style="text-align: right;">26.7</td>
<td style="text-align: left;">▁▃▇▂▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">estimate_medinc_25_34K</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">11.87</td>
<td style="text-align: right;">2.49</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">10.5</td>
<td style="text-align: right;">11.9</td>
<td style="text-align: right;">13.3</td>
<td style="text-align: right;">32.9</td>
<td style="text-align: left;">▁▇▃▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">estimate_medinc_35_49K</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">14.99</td>
<td style="text-align: right;">2.46</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">13.6</td>
<td style="text-align: right;">15.0</td>
<td style="text-align: right;">16.5</td>
<td style="text-align: right;">29.8</td>
<td style="text-align: left;">▁▅▇▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">estimate_medinc_50_74K</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">18.60</td>
<td style="text-align: right;">2.90</td>
<td style="text-align: right;">6.9</td>
<td style="text-align: right;">16.9</td>
<td style="text-align: right;">18.6</td>
<td style="text-align: right;">20.4</td>
<td style="text-align: right;">34.1</td>
<td style="text-align: left;">▁▅▇▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">estimate_medinc_75_99K</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">11.46</td>
<td style="text-align: right;">2.80</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">9.6</td>
<td style="text-align: right;">11.5</td>
<td style="text-align: right;">13.4</td>
<td style="text-align: right;">23.0</td>
<td style="text-align: left;">▁▃▇▂▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">estimate_medinc_100_149K</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">9.86</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: right;">0.9</td>
<td style="text-align: right;">7.0</td>
<td style="text-align: right;">9.2</td>
<td style="text-align: right;">11.9</td>
<td style="text-align: right;">29.1</td>
<td style="text-align: left;">▃▇▂▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">estimate_medinc_150_199K</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.87</td>
<td style="text-align: right;">2.07</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: right;">3.5</td>
<td style="text-align: right;">16.9</td>
<td style="text-align: left;">▇▂▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">estimate_medinc_200Kplus</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.37</td>
<td style="text-align: right;">2.22</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">1.1</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">23.1</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(counties_medinc_wide, adj_est_medinc_lt_10K<span class="sc">:</span>adj_est_medinc_200Kplus)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">counties_medinc_wide</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">3143</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">49</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 26%">
<col style="width: 11%">
<col style="width: 15%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">adj_est_medinc_lt_10K</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: left;">▃▇▂▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">adj_est_medinc_10_14K</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: left;">▂▇▂▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">adj_est_medinc_15_24K</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.27</td>
<td style="text-align: left;">▁▃▇▂▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">adj_est_medinc_25_34K</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">0.33</td>
<td style="text-align: left;">▁▇▃▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">adj_est_medinc_35_49K</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: left;">▁▅▇▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">adj_est_medinc_50_74K</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: left;">▁▅▇▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">adj_est_medinc_75_99K</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: left;">▁▃▇▂▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">adj_est_medinc_100_149K</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.29</td>
<td style="text-align: left;">▃▇▂▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">adj_est_medinc_150_199K</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: left;">▇▂▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">adj_est_medinc_200Kplus</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(counties_medinc_wide, medinc_lt_10K_est_count<span class="sc">:</span>medinc_gt100K_est_count)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">counties_medinc_wide</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">3143</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">49</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">13</td>
</tr>
<tr class="odd">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 23%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">medinc_lt_10K_est_count</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2666.53</td>
<td style="text-align: right;">8215.07</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">345.09</td>
<td style="text-align: right;">847.28</td>
<td style="text-align: right;">1947.26</td>
<td style="text-align: right;">209974.9</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">medinc_10_14K_est_count</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1976.55</td>
<td style="text-align: right;">5871.53</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">296.42</td>
<td style="text-align: right;">692.50</td>
<td style="text-align: right;">1550.72</td>
<td style="text-align: right;">190592.6</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">medinc_15_24K_est_count</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3968.08</td>
<td style="text-align: right;">11474.07</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">583.93</td>
<td style="text-align: right;">1343.68</td>
<td style="text-align: right;">3105.58</td>
<td style="text-align: right;">342420.6</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">medinc_25_34K_est_count</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3795.90</td>
<td style="text-align: right;">10858.85</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">516.92</td>
<td style="text-align: right;">1194.45</td>
<td style="text-align: right;">2939.29</td>
<td style="text-align: right;">310116.8</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">medinc_35_49K_est_count</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5002.67</td>
<td style="text-align: right;">14370.51</td>
<td style="text-align: right;">2.01</td>
<td style="text-align: right;">662.47</td>
<td style="text-align: right;">1504.40</td>
<td style="text-align: right;">3810.19</td>
<td style="text-align: right;">410258.6</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">medinc_50_74K_est_count</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6601.40</td>
<td style="text-align: right;">19138.49</td>
<td style="text-align: right;">5.02</td>
<td style="text-align: right;">769.36</td>
<td style="text-align: right;">1795.37</td>
<td style="text-align: right;">4838.91</td>
<td style="text-align: right;">545934.7</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">medinc_75_99K_est_count</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4488.27</td>
<td style="text-align: right;">13488.44</td>
<td style="text-align: right;">3.95</td>
<td style="text-align: right;">444.29</td>
<td style="text-align: right;">1089.74</td>
<td style="text-align: right;">3030.84</td>
<td style="text-align: right;">384415.6</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">medinc_100_149K_est_count</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4728.11</td>
<td style="text-align: right;">15646.69</td>
<td style="text-align: right;">3.99</td>
<td style="text-align: right;">328.98</td>
<td style="text-align: right;">860.34</td>
<td style="text-align: right;">2710.66</td>
<td style="text-align: right;">439332.1</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">medinc_150_199K_est_count</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1798.74</td>
<td style="text-align: right;">6919.86</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">74.12</td>
<td style="text-align: right;">214.83</td>
<td style="text-align: right;">760.00</td>
<td style="text-align: right;">190592.6</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">medinc_200Kplus_est_count</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1761.21</td>
<td style="text-align: right;">8003.85</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">54.84</td>
<td style="text-align: right;">156.90</td>
<td style="text-align: right;">554.43</td>
<td style="text-align: right;">213205.3</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">medinc_lt25K_est_count</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8611.17</td>
<td style="text-align: right;">25419.35</td>
<td style="text-align: right;">10.99</td>
<td style="text-align: right;">1260.33</td>
<td style="text-align: right;">2887.38</td>
<td style="text-align: right;">6595.01</td>
<td style="text-align: right;">742988.1</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">medinc_25_49K_est_count</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8798.57</td>
<td style="text-align: right;">25216.24</td>
<td style="text-align: right;">2.01</td>
<td style="text-align: right;">1198.59</td>
<td style="text-align: right;">2706.75</td>
<td style="text-align: right;">6844.39</td>
<td style="text-align: right;">720375.4</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">medinc_gt100K_est_count</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8288.06</td>
<td style="text-align: right;">30200.55</td>
<td style="text-align: right;">6.02</td>
<td style="text-align: right;">472.46</td>
<td style="text-align: right;">1251.20</td>
<td style="text-align: right;">4020.43</td>
<td style="text-align: right;">843130.0</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="do">###??? Some sums differ from totals - likely due to rounding - how handle?</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a><span class="do">###??? After resolve - Drop unnecessary vars</span></span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a><span class="co"># counties_medinc_wide &lt;- counties_medinc_wide %&gt;%</span></span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  dplyr::select(!c(medinc_lt_10K_estimate:medinc_200Kplus_estimate))</span></span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-7"><a href="#cb160-7" aria-hidden="true" tabindex="-1"></a><span class="co"># counties_medinc_wide &lt;- counties_medinc_wide %&gt;%</span></span>
<span id="cb160-8"><a href="#cb160-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   dplyr::select(!c(medinc_lt_10K_estimate_adj:medinc_35_49K_est_count))</span></span>
<span id="cb160-9"><a href="#cb160-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-10"><a href="#cb160-10" aria-hidden="true" tabindex="-1"></a><span class="co"># counties_medinc_wide &lt;- counties_medinc_wide %&gt;%</span></span>
<span id="cb160-11"><a href="#cb160-11" aria-hidden="true" tabindex="-1"></a><span class="co">#  dplyr::select(!c(medinc_100_149K_est_count:medinc_200Kplus_est_count))</span></span>
<span id="cb160-12"><a href="#cb160-12" aria-hidden="true" tabindex="-1"></a><span class="co"># view(counties_medinc_wide)  </span></span>
<span id="cb160-13"><a href="#cb160-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-14"><a href="#cb160-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Reorder vars</span></span>
<span id="cb160-15"><a href="#cb160-15" aria-hidden="true" tabindex="-1"></a><span class="co"># counties_medinc_wide &lt;- counties_medinc_wide %&gt;% </span></span>
<span id="cb160-16"><a href="#cb160-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   relocate(medinc_lt25K_est_count, medinc_25_49K_est_count, </span></span>
<span id="cb160-17"><a href="#cb160-17" aria-hidden="true" tabindex="-1"></a><span class="co">#           .before = medinc_50_74K_est_count)</span></span>
<span id="cb160-18"><a href="#cb160-18" aria-hidden="true" tabindex="-1"></a><span class="co">#  view(counties_medinc_wide)</span></span>
<span id="cb160-19"><a href="#cb160-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-20"><a href="#cb160-20" aria-hidden="true" tabindex="-1"></a><span class="do">###??? Not sure what I do w/ medinc_moe</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Rename variables so understandable - selecting poverty all under 18, not</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="co"># related children under 18 (004 instead of 003)</span></span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>counties_poverty <span class="ot">&lt;-</span> counties_poverty <span class="sc">%&gt;%</span></span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">variable  =</span> <span class="fu">case_when</span>(</span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"S1701_C01_001"</span> <span class="sc">~</span> <span class="st">"pov_total"</span>,</span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"S1701_C01_002"</span> <span class="sc">~</span> <span class="st">"pov_under18"</span>,</span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"S1701_C01_004"</span> <span class="sc">~</span> <span class="st">"pov_18_64"</span>,</span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"S1701_C01_005"</span> <span class="sc">~</span> <span class="st">"pov_65plus"</span>))</span>
<span id="cb161-9"><a href="#cb161-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-10"><a href="#cb161-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Pivot from long to wide</span></span>
<span id="cb161-11"><a href="#cb161-11" aria-hidden="true" tabindex="-1"></a>counties_poverty_wide <span class="ot">&lt;-</span> counties_poverty <span class="sc">%&gt;%</span></span>
<span id="cb161-12"><a href="#cb161-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb161-13"><a href="#cb161-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> variable,</span>
<span id="cb161-14"><a href="#cb161-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> <span class="fu">c</span>(estimate, moe))</span>
<span id="cb161-15"><a href="#cb161-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-16"><a href="#cb161-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Check sums</span></span>
<span id="cb161-17"><a href="#cb161-17" aria-hidden="true" tabindex="-1"></a>counties_poverty_wide <span class="ot">&lt;-</span> counties_poverty_wide <span class="sc">%&gt;%</span></span>
<span id="cb161-18"><a href="#cb161-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">check_poverty_sums =</span> estimate_pov_under18 <span class="sc">+</span> </span>
<span id="cb161-19"><a href="#cb161-19" aria-hidden="true" tabindex="-1"></a>                         estimate_pov_18_64 <span class="sc">+</span></span>
<span id="cb161-20"><a href="#cb161-20" aria-hidden="true" tabindex="-1"></a>                         estimate_pov_65plus)</span>
<span id="cb161-21"><a href="#cb161-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-22"><a href="#cb161-22" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(counties_poverty_wide<span class="sc">$</span>check_poverty_sums)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
     68   10862   25087   95418   64062 9738370 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>counties_poverty_wide <span class="ot">&lt;-</span> counties_poverty_wide <span class="sc">%&gt;%</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">check_pov_diff =</span> <span class="fu">ifelse</span>(estimate_pov_total <span class="sc">!=</span> check_poverty_sums, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(counties_poverty_wide<span class="sc">$</span>check_pov_diff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
      0       0       0       0       0       0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="do">## No sums differ from totals - drop check vars</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>counties_poverty_wide <span class="ot">&lt;-</span> counties_poverty_wide <span class="sc">%&gt;%</span></span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span><span class="fu">c</span>(check_poverty_sums, check_pov_diff))</span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop outlying areas</span></span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a>counties_poverty_wide  <span class="ot">&lt;-</span> counties_poverty_wide <span class="sc">%&gt;%</span></span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">as.numeric</span>(<span class="fu">substr</span>(GEOID, <span class="dv">1</span>, <span class="dv">2</span>)) <span class="sc">&lt;=</span> <span class="dv">56</span>)</span>
<span id="cb165-8"><a href="#cb165-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-9"><a href="#cb165-9" aria-hidden="true" tabindex="-1"></a>check_poverty_states <span class="ot">&lt;-</span> counties_poverty_wide <span class="sc">%&gt;%</span></span>
<span id="cb165-10"><a href="#cb165-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">as.numeric</span>(<span class="fu">substr</span>(GEOID, <span class="dv">1</span>, <span class="dv">2</span>)) <span class="sc">&gt;</span> <span class="dv">56</span>)</span>
<span id="cb165-11"><a href="#cb165-11" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(check_poverty_states)  <span class="do">## 0 obs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt; table of extent 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 &gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(counties_poverty_wide, <span class="st">"counties_poverty_wide.rds"</span>)</span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Run basic descriptives </span></span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(counties_poverty_wide)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">counties_poverty_wide</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">3143</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">10</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">GEOID</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3143</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">NAME</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3143</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 20%">
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 2%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">estimate_pov_total</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">96624.90</td>
<td style="text-align: right;">311240.78</td>
<td style="text-align: right;">68</td>
<td style="text-align: right;">10640.0</td>
<td style="text-align: right;">24611</td>
<td style="text-align: right;">64504.5</td>
<td style="text-align: right;">9738370</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">estimate_pov_under18</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">23146.23</td>
<td style="text-align: right;">75765.18</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2482.5</td>
<td style="text-align: right;">5896</td>
<td style="text-align: right;">15037.5</td>
<td style="text-align: right;">2337835</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">estimate_pov_18_64</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">60578.69</td>
<td style="text-align: right;">199657.26</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">6289.5</td>
<td style="text-align: right;">14906</td>
<td style="text-align: right;">39748.5</td>
<td style="text-align: right;">6317776</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">estimate_pov_65plus</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">12899.98</td>
<td style="text-align: right;">36981.19</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1812.5</td>
<td style="text-align: right;">3923</td>
<td style="text-align: right;">9838.5</td>
<td style="text-align: right;">1082759</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">moe_pov_total</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">275.79</td>
<td style="text-align: right;">295.59</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">96.0</td>
<td style="text-align: right;">178</td>
<td style="text-align: right;">340.0</td>
<td style="text-align: right;">3163</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">moe_pov_under18</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">132.31</td>
<td style="text-align: right;">127.41</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">54.0</td>
<td style="text-align: right;">97</td>
<td style="text-align: right;">166.5</td>
<td style="text-align: right;">1637</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">moe_pov_18_64</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">226.05</td>
<td style="text-align: right;">258.10</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">71.0</td>
<td style="text-align: right;">137</td>
<td style="text-align: right;">273.0</td>
<td style="text-align: right;">2445</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">moe_pov_65plus</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">119.30</td>
<td style="text-align: right;">85.00</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">65.0</td>
<td style="text-align: right;">99</td>
<td style="text-align: right;">149.0</td>
<td style="text-align: right;">1005</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(counties_poverty_wide, <span class="st">"counties_poverty_wide.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Rename variables so understandable - selecting poverty all under 18, not</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="co"># related children under 18 (004 instead of 003)</span></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>counties_IPR <span class="ot">&lt;-</span> counties_IPR <span class="sc">%&gt;%</span></span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">variable  =</span> <span class="fu">case_when</span>(</span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"C17002_001"</span> <span class="sc">~</span> <span class="st">"IPR_total"</span>,</span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"C17002_002"</span> <span class="sc">~</span> <span class="st">"IPR_under50"</span>,</span>
<span id="cb169-7"><a href="#cb169-7" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"C17002_003"</span> <span class="sc">~</span> <span class="st">"IPR_50_99"</span>,</span>
<span id="cb169-8"><a href="#cb169-8" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"C17002_004"</span> <span class="sc">~</span> <span class="st">"IPR_1_124"</span>,</span>
<span id="cb169-9"><a href="#cb169-9" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"C17002_005"</span> <span class="sc">~</span> <span class="st">"IPR_125_149"</span>,</span>
<span id="cb169-10"><a href="#cb169-10" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"C17002_006"</span> <span class="sc">~</span> <span class="st">"IPR_150_184"</span>,</span>
<span id="cb169-11"><a href="#cb169-11" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"C17002_007"</span> <span class="sc">~</span> <span class="st">"IPR_185_199"</span>,</span>
<span id="cb169-12"><a href="#cb169-12" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"C17002_008"</span> <span class="sc">~</span> <span class="st">"IPR_200over"</span>))</span>
<span id="cb169-13"><a href="#cb169-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-14"><a href="#cb169-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Pivot from long to wide</span></span>
<span id="cb169-15"><a href="#cb169-15" aria-hidden="true" tabindex="-1"></a>counties_IPR_wide <span class="ot">&lt;-</span> counties_IPR <span class="sc">%&gt;%</span></span>
<span id="cb169-16"><a href="#cb169-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb169-17"><a href="#cb169-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> variable,</span>
<span id="cb169-18"><a href="#cb169-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> <span class="fu">c</span>(estimate, moe))</span>
<span id="cb169-19"><a href="#cb169-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-20"><a href="#cb169-20" aria-hidden="true" tabindex="-1"></a><span class="do">## Check sums</span></span>
<span id="cb169-21"><a href="#cb169-21" aria-hidden="true" tabindex="-1"></a>counties_IPR_wide <span class="ot">&lt;-</span> counties_IPR_wide <span class="sc">%&gt;%</span></span>
<span id="cb169-22"><a href="#cb169-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">check_IPR_sums =</span> </span>
<span id="cb169-23"><a href="#cb169-23" aria-hidden="true" tabindex="-1"></a>      estimate_IPR_under50 <span class="sc">+</span>  </span>
<span id="cb169-24"><a href="#cb169-24" aria-hidden="true" tabindex="-1"></a>      estimate_IPR_50_99 <span class="sc">+</span>  </span>
<span id="cb169-25"><a href="#cb169-25" aria-hidden="true" tabindex="-1"></a>      estimate_IPR_1_124 <span class="sc">+</span> </span>
<span id="cb169-26"><a href="#cb169-26" aria-hidden="true" tabindex="-1"></a>      estimate_IPR_125_149 <span class="sc">+</span> </span>
<span id="cb169-27"><a href="#cb169-27" aria-hidden="true" tabindex="-1"></a>      estimate_IPR_150_184 <span class="sc">+</span> </span>
<span id="cb169-28"><a href="#cb169-28" aria-hidden="true" tabindex="-1"></a>      estimate_IPR_185_199 <span class="sc">+</span> </span>
<span id="cb169-29"><a href="#cb169-29" aria-hidden="true" tabindex="-1"></a>      estimate_IPR_200over)</span>
<span id="cb169-30"><a href="#cb169-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-31"><a href="#cb169-31" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(counties_IPR_wide<span class="sc">$</span>check_IPR_sums)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
     68   10862   25087   95418   64062 9738370 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>counties_IPR_wide <span class="ot">&lt;-</span> counties_IPR_wide <span class="sc">%&gt;%</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">check_IPR_diff =</span> <span class="fu">ifelse</span>(estimate_IPR_total <span class="sc">!=</span> check_IPR_sums, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(counties_IPR_wide<span class="sc">$</span>check_IPR_diff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
      0       0       0       0       0       0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="do">## No sums differ from totals - drop check vars</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>counties_IPR_wide <span class="ot">&lt;-</span> counties_IPR_wide <span class="sc">%&gt;%</span></span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span><span class="fu">c</span>(check_IPR_sums, check_IPR_diff))</span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop outlying areas</span></span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a>counties_IPR_wide  <span class="ot">&lt;-</span> counties_IPR_wide <span class="sc">%&gt;%</span></span>
<span id="cb173-7"><a href="#cb173-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">as.numeric</span>(<span class="fu">substr</span>(GEOID, <span class="dv">1</span>, <span class="dv">2</span>)) <span class="sc">&lt;=</span> <span class="dv">56</span>)</span>
<span id="cb173-8"><a href="#cb173-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-9"><a href="#cb173-9" aria-hidden="true" tabindex="-1"></a>check_IPR_states <span class="ot">&lt;-</span> counties_IPR_wide <span class="sc">%&gt;%</span></span>
<span id="cb173-10"><a href="#cb173-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">as.numeric</span>(<span class="fu">substr</span>(GEOID, <span class="dv">1</span>, <span class="dv">2</span>)) <span class="sc">&gt;</span> <span class="dv">56</span>)</span>
<span id="cb173-11"><a href="#cb173-11" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(check_IPR_states)  <span class="do">## 0 obs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt; table of extent 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 &gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Run basic descriptives </span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(counties_IPR_wide)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">counties_IPR_wide</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">3143</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">18</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">16</td>
</tr>
<tr class="even">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">GEOID</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3143</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">NAME</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3143</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 20%">
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 2%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">estimate_IPR_total</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">96624.90</td>
<td style="text-align: right;">311240.78</td>
<td style="text-align: right;">68</td>
<td style="text-align: right;">10640.0</td>
<td style="text-align: right;">24611</td>
<td style="text-align: right;">64504.5</td>
<td style="text-align: right;">9738370</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">estimate_IPR_under50</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6557.39</td>
<td style="text-align: right;">23108.26</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">670.5</td>
<td style="text-align: right;">1743</td>
<td style="text-align: right;">4438.5</td>
<td style="text-align: right;">727731</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">estimate_IPR_50_99</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8289.40</td>
<td style="text-align: right;">29768.92</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1022.5</td>
<td style="text-align: right;">2516</td>
<td style="text-align: right;">5783.5</td>
<td style="text-align: right;">1009493</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">estimate_IPR_1_124</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4577.68</td>
<td style="text-align: right;">16516.41</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">581.5</td>
<td style="text-align: right;">1406</td>
<td style="text-align: right;">3293.0</td>
<td style="text-align: right;">588784</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">estimate_IPR_125_149</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4665.19</td>
<td style="text-align: right;">16329.00</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">613.0</td>
<td style="text-align: right;">1443</td>
<td style="text-align: right;">3332.5</td>
<td style="text-align: right;">573755</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">estimate_IPR_150_184</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6422.11</td>
<td style="text-align: right;">21549.27</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">833.0</td>
<td style="text-align: right;">1985</td>
<td style="text-align: right;">4743.5</td>
<td style="text-align: right;">737841</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">estimate_IPR_185_199</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2566.33</td>
<td style="text-align: right;">8390.20</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">325.5</td>
<td style="text-align: right;">800</td>
<td style="text-align: right;">1973.5</td>
<td style="text-align: right;">284877</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">estimate_IPR_200over</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">63546.81</td>
<td style="text-align: right;">199933.78</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">6123.5</td>
<td style="text-align: right;">14613</td>
<td style="text-align: right;">40408.5</td>
<td style="text-align: right;">5815889</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">moe_IPR_total</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">275.79</td>
<td style="text-align: right;">295.59</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">96.0</td>
<td style="text-align: right;">178</td>
<td style="text-align: right;">340.0</td>
<td style="text-align: right;">3163</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">moe_IPR_under50</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">629.62</td>
<td style="text-align: right;">743.26</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">216.0</td>
<td style="text-align: right;">427</td>
<td style="text-align: right;">753.5</td>
<td style="text-align: right;">10499</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">moe_IPR_50_99</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">738.51</td>
<td style="text-align: right;">850.39</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">270.0</td>
<td style="text-align: right;">510</td>
<td style="text-align: right;">871.0</td>
<td style="text-align: right;">13147</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">moe_IPR_1_124</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">567.54</td>
<td style="text-align: right;">663.89</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">206.0</td>
<td style="text-align: right;">385</td>
<td style="text-align: right;">660.5</td>
<td style="text-align: right;">9900</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">moe_IPR_125_149</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">576.78</td>
<td style="text-align: right;">665.69</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">211.0</td>
<td style="text-align: right;">392</td>
<td style="text-align: right;">681.0</td>
<td style="text-align: right;">11043</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">moe_IPR_150_184</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">666.47</td>
<td style="text-align: right;">754.58</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">241.0</td>
<td style="text-align: right;">454</td>
<td style="text-align: right;">784.5</td>
<td style="text-align: right;">11699</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">moe_IPR_185_199</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">431.41</td>
<td style="text-align: right;">498.92</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">150.5</td>
<td style="text-align: right;">292</td>
<td style="text-align: right;">518.0</td>
<td style="text-align: right;">6982</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">moe_IPR_200over</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1141.34</td>
<td style="text-align: right;">1303.41</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">445.0</td>
<td style="text-align: right;">770</td>
<td style="text-align: right;">1329.0</td>
<td style="text-align: right;">20620</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(counties_IPR_wide, <span class="st">"counties_IPR_wide.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Rename variables so understandable</span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>counties_ed <span class="ot">&lt;-</span> counties_ed <span class="sc">%&gt;%</span></span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">variable  =</span> <span class="fu">case_when</span>(</span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"DP02_0058"</span> <span class="sc">~</span> <span class="st">"ed_total"</span>,</span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"DP02_0059"</span> <span class="sc">~</span> <span class="st">"lt_gr9"</span>,</span>
<span id="cb177-6"><a href="#cb177-6" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"DP02_0060"</span> <span class="sc">~</span> <span class="st">"gr9_12_nodip"</span>,</span>
<span id="cb177-7"><a href="#cb177-7" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"DP02_0061"</span> <span class="sc">~</span> <span class="st">"hs_grad"</span>,</span>
<span id="cb177-8"><a href="#cb177-8" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"DP02_0062"</span> <span class="sc">~</span> <span class="st">"some_college"</span>,</span>
<span id="cb177-9"><a href="#cb177-9" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"DP02_0063"</span> <span class="sc">~</span> <span class="st">"assoc"</span>,</span>
<span id="cb177-10"><a href="#cb177-10" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"DP02_0064"</span> <span class="sc">~</span> <span class="st">"bach"</span>,</span>
<span id="cb177-11"><a href="#cb177-11" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"DP02_0065"</span> <span class="sc">~</span> <span class="st">"grad_prof"</span>,</span>
<span id="cb177-12"><a href="#cb177-12" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb177-13"><a href="#cb177-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-14"><a href="#cb177-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Pivot from long to wide</span></span>
<span id="cb177-15"><a href="#cb177-15" aria-hidden="true" tabindex="-1"></a>counties_ed_wide <span class="ot">&lt;-</span> counties_ed <span class="sc">%&gt;%</span></span>
<span id="cb177-16"><a href="#cb177-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb177-17"><a href="#cb177-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> variable,</span>
<span id="cb177-18"><a href="#cb177-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> <span class="fu">c</span>(estimate, moe))</span>
<span id="cb177-19"><a href="#cb177-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-20"><a href="#cb177-20" aria-hidden="true" tabindex="-1"></a><span class="do">## Collapse to wider bins</span></span>
<span id="cb177-21"><a href="#cb177-21" aria-hidden="true" tabindex="-1"></a>counties_ed_wide <span class="ot">&lt;-</span> counties_ed_wide <span class="sc">%&gt;%</span></span>
<span id="cb177-22"><a href="#cb177-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( </span>
<span id="cb177-23"><a href="#cb177-23" aria-hidden="true" tabindex="-1"></a>   <span class="at">estimate_lt_hsgrad =</span> estimate_lt_gr9 <span class="sc">+</span> estimate_gr9_12_nodip,</span>
<span id="cb177-24"><a href="#cb177-24" aria-hidden="true" tabindex="-1"></a>   <span class="at">estimate_somecoll_assoc =</span> estimate_some_college <span class="sc">+</span> estimate_assoc)</span>
<span id="cb177-25"><a href="#cb177-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-26"><a href="#cb177-26" aria-hidden="true" tabindex="-1"></a><span class="do">## Check sums</span></span>
<span id="cb177-27"><a href="#cb177-27" aria-hidden="true" tabindex="-1"></a>counties_ed_wide <span class="ot">&lt;-</span> counties_ed_wide <span class="sc">%&gt;%</span></span>
<span id="cb177-28"><a href="#cb177-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb177-29"><a href="#cb177-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">check_ed_sums =</span> estimate_lt_hsgrad <span class="sc">+</span> </span>
<span id="cb177-30"><a href="#cb177-30" aria-hidden="true" tabindex="-1"></a>                    estimate_hs_grad <span class="sc">+</span>  </span>
<span id="cb177-31"><a href="#cb177-31" aria-hidden="true" tabindex="-1"></a>                    estimate_somecoll_assoc <span class="sc">+</span></span>
<span id="cb177-32"><a href="#cb177-32" aria-hidden="true" tabindex="-1"></a>                    estimate_bach <span class="sc">+</span></span>
<span id="cb177-33"><a href="#cb177-33" aria-hidden="true" tabindex="-1"></a>                    estimate_grad_prof)</span>
<span id="cb177-34"><a href="#cb177-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-35"><a href="#cb177-35" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(counties_ed_wide<span class="sc">$</span>check_ed_sums)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
     65    7537   17477   65730   44758 6456772      78 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>counties_ed_wide <span class="ot">&lt;-</span> counties_ed_wide <span class="sc">%&gt;%</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">check_ed_diff =</span> <span class="fu">ifelse</span>(estimate_ed_total <span class="sc">!=</span> check_ed_sums, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(counties_ed_wide<span class="sc">$</span>check_ed_diff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
      0       0       0       0       0       0      78 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="do">## No sums differ from totals - drop check vars</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>counties_ed_wide <span class="ot">&lt;-</span> counties_ed_wide <span class="sc">%&gt;%</span></span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span><span class="fu">c</span>(check_ed_sums, check_ed_diff))</span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop outlying areas</span></span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a>counties_ed_wide  <span class="ot">&lt;-</span> counties_ed_wide <span class="sc">%&gt;%</span></span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">as.numeric</span>(<span class="fu">substr</span>(GEOID, <span class="dv">1</span>, <span class="dv">2</span>)) <span class="sc">&lt;=</span> <span class="dv">56</span>)</span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-9"><a href="#cb181-9" aria-hidden="true" tabindex="-1"></a>check_ed_states <span class="ot">&lt;-</span> counties_ed_wide <span class="sc">%&gt;%</span></span>
<span id="cb181-10"><a href="#cb181-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">as.numeric</span>(<span class="fu">substr</span>(GEOID, <span class="dv">1</span>, <span class="dv">2</span>)) <span class="sc">&gt;</span> <span class="dv">56</span>)</span>
<span id="cb181-11"><a href="#cb181-11" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(check_ed_states)  <span class="do">## 0 obs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt; table of extent 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 &gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Run basic descriptives </span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(counties_ed_wide)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">counties_ed_wide</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">3143</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">20</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">18</td>
</tr>
<tr class="even">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">GEOID</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3143</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">NAME</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3143</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 22%">
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 2%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">estimate_ed_total</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">65729.51</td>
<td style="text-align: right;">207934.74</td>
<td style="text-align: right;">65</td>
<td style="text-align: right;">7537.0</td>
<td style="text-align: right;">17477</td>
<td style="text-align: right;">44757.5</td>
<td style="text-align: right;">6456772</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">estimate_lt_gr9</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">3904.81</td>
<td style="text-align: right;">20831.64</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">417.5</td>
<td style="text-align: right;">1017</td>
<td style="text-align: right;">2305.5</td>
<td style="text-align: right;">881733</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">estimate_gr9_12_nodip</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">5286.32</td>
<td style="text-align: right;">18014.11</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">700.5</td>
<td style="text-align: right;">1765</td>
<td style="text-align: right;">4065.0</td>
<td style="text-align: right;">628604</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">estimate_hs_grad</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">18480.58</td>
<td style="text-align: right;">48553.10</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">2799.5</td>
<td style="text-align: right;">6399</td>
<td style="text-align: right;">15167.0</td>
<td style="text-align: right;">1323720</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">estimate_some_college</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">13966.51</td>
<td style="text-align: right;">42524.11</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">1642.0</td>
<td style="text-align: right;">3705</td>
<td style="text-align: right;">9880.5</td>
<td style="text-align: right;">1263141</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">estimate_assoc</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">5133.88</td>
<td style="text-align: right;">15168.49</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">538.5</td>
<td style="text-align: right;">1324</td>
<td style="text-align: right;">3809.5</td>
<td style="text-align: right;">443294</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">estimate_bach</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">11863.27</td>
<td style="text-align: right;">42774.32</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">732.5</td>
<td style="text-align: right;">1841</td>
<td style="text-align: right;">5870.0</td>
<td style="text-align: right;">1254787</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">estimate_grad_prof</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">7094.14</td>
<td style="text-align: right;">26377.23</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">350.0</td>
<td style="text-align: right;">974</td>
<td style="text-align: right;">3181.0</td>
<td style="text-align: right;">661493</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">moe_ed_total</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">102.77</td>
<td style="text-align: right;">61.56</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">60.0</td>
<td style="text-align: right;">93</td>
<td style="text-align: right;">135.0</td>
<td style="text-align: right;">1025</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">moe_lt_gr9</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">285.00</td>
<td style="text-align: right;">360.40</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">106.5</td>
<td style="text-align: right;">191</td>
<td style="text-align: right;">321.0</td>
<td style="text-align: right;">6049</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">moe_gr9_12_nodip</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">358.98</td>
<td style="text-align: right;">381.81</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">140.0</td>
<td style="text-align: right;">259</td>
<td style="text-align: right;">428.5</td>
<td style="text-align: right;">5510</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">moe_hs_grad</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">592.17</td>
<td style="text-align: right;">620.61</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">240.5</td>
<td style="text-align: right;">415</td>
<td style="text-align: right;">697.5</td>
<td style="text-align: right;">8374</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">moe_some_college</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">515.72</td>
<td style="text-align: right;">563.37</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">202.0</td>
<td style="text-align: right;">343</td>
<td style="text-align: right;">610.5</td>
<td style="text-align: right;">8228</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">moe_assoc</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">330.22</td>
<td style="text-align: right;">362.99</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">124.0</td>
<td style="text-align: right;">217</td>
<td style="text-align: right;">394.0</td>
<td style="text-align: right;">5113</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">moe_bach</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">440.37</td>
<td style="text-align: right;">552.90</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">147.0</td>
<td style="text-align: right;">258</td>
<td style="text-align: right;">490.5</td>
<td style="text-align: right;">7608</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">moe_grad_prof</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">335.27</td>
<td style="text-align: right;">458.20</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">101.0</td>
<td style="text-align: right;">187</td>
<td style="text-align: right;">363.5</td>
<td style="text-align: right;">6986</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">estimate_lt_hsgrad</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">9191.13</td>
<td style="text-align: right;">38451.87</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1130.0</td>
<td style="text-align: right;">2831</td>
<td style="text-align: right;">6352.5</td>
<td style="text-align: right;">1510337</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">estimate_somecoll_assoc</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">19100.39</td>
<td style="text-align: right;">57511.20</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">2225.5</td>
<td style="text-align: right;">5019</td>
<td style="text-align: right;">13687.0</td>
<td style="text-align: right;">1706435</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Reorder vars</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>counties_ed_wide <span class="ot">&lt;-</span> counties_ed_wide <span class="sc">%&gt;%</span> </span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(estimate_lt_hsgrad, <span class="at">.before =</span> estimate_hs_grad)</span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true" tabindex="-1"></a>counties_ed_wide <span class="ot">&lt;-</span> counties_ed_wide <span class="sc">%&gt;%</span> </span>
<span id="cb184-6"><a href="#cb184-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(estimate_somecoll_assoc, <span class="at">.before =</span> estimate_bach)</span>
<span id="cb184-7"><a href="#cb184-7" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb184-8"><a href="#cb184-8" aria-hidden="true" tabindex="-1"></a> counties_ed_wide <span class="ot">&lt;-</span> counties_ed_wide <span class="sc">%&gt;%</span></span>
<span id="cb184-9"><a href="#cb184-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span><span class="fu">c</span>(estimate_lt_gr9, estimate_gr9_12_nodip, estimate_some_college,</span>
<span id="cb184-10"><a href="#cb184-10" aria-hidden="true" tabindex="-1"></a>            estimate_assoc)) </span>
<span id="cb184-11"><a href="#cb184-11" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb184-12"><a href="#cb184-12" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(counties_ed_wide, <span class="st">"counties_ed_wide.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Rename variables so understandable</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>counties_industry <span class="ot">&lt;-</span> counties_industry <span class="sc">%&gt;%</span></span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">variable  =</span> <span class="fu">case_when</span>(</span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"S2405_C01_001"</span> <span class="sc">~</span> <span class="st">"civ_emp_pop_total"</span>,</span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"S2405_C01_002"</span> <span class="sc">~</span> <span class="st">"AgForFishHuntMin"</span>,</span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"S2405_C01_003"</span> <span class="sc">~</span> <span class="st">"Construct"</span>,</span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"S2405_C01_004"</span> <span class="sc">~</span> <span class="st">"Manu"</span>,</span>
<span id="cb185-8"><a href="#cb185-8" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"S2405_C01_005"</span> <span class="sc">~</span> <span class="st">"Wholesale"</span>,</span>
<span id="cb185-9"><a href="#cb185-9" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"S2405_C01_006"</span> <span class="sc">~</span> <span class="st">"Retail"</span>,</span>
<span id="cb185-10"><a href="#cb185-10" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"S2405_C01_007"</span> <span class="sc">~</span> <span class="st">"TransWareUtil"</span>,</span>
<span id="cb185-11"><a href="#cb185-11" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"S2405_C01_008"</span> <span class="sc">~</span> <span class="st">"Info"</span>,</span>
<span id="cb185-12"><a href="#cb185-12" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"S2405_C01_009"</span> <span class="sc">~</span> <span class="st">"FinInsRE"</span>,</span>
<span id="cb185-13"><a href="#cb185-13" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"S2405_C01_010"</span> <span class="sc">~</span> <span class="st">"Prof"</span>,</span>
<span id="cb185-14"><a href="#cb185-14" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"S2405_C01_011"</span> <span class="sc">~</span> <span class="st">"EdHlthSoc"</span>,</span>
<span id="cb185-15"><a href="#cb185-15" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"S2405_C01_012"</span> <span class="sc">~</span> <span class="st">"ArtEntRecAcc"</span>,</span>
<span id="cb185-16"><a href="#cb185-16" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"S2405_C01_013"</span> <span class="sc">~</span> <span class="st">"OthSvcs"</span>,</span>
<span id="cb185-17"><a href="#cb185-17" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"S2405_C01_014"</span> <span class="sc">~</span> <span class="st">"PubAdmin"</span>,</span>
<span id="cb185-18"><a href="#cb185-18" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb185-19"><a href="#cb185-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-20"><a href="#cb185-20" aria-hidden="true" tabindex="-1"></a><span class="do">## Pivot from long to wide</span></span>
<span id="cb185-21"><a href="#cb185-21" aria-hidden="true" tabindex="-1"></a>counties_industry_wide <span class="ot">&lt;-</span> counties_industry <span class="sc">%&gt;%</span></span>
<span id="cb185-22"><a href="#cb185-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb185-23"><a href="#cb185-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> variable,</span>
<span id="cb185-24"><a href="#cb185-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> <span class="fu">c</span>(estimate, moe))</span>
<span id="cb185-25"><a href="#cb185-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-26"><a href="#cb185-26" aria-hidden="true" tabindex="-1"></a><span class="do">## Collapse to wider bins</span></span>
<span id="cb185-27"><a href="#cb185-27" aria-hidden="true" tabindex="-1"></a>counties_industry_wide <span class="ot">&lt;-</span> counties_industry_wide <span class="sc">%&gt;%</span></span>
<span id="cb185-28"><a href="#cb185-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( </span>
<span id="cb185-29"><a href="#cb185-29" aria-hidden="true" tabindex="-1"></a>   <span class="at">estimate_TTUC =</span> estimate_Construct <span class="sc">+</span> </span>
<span id="cb185-30"><a href="#cb185-30" aria-hidden="true" tabindex="-1"></a>                   estimate_Wholesale <span class="sc">+</span>  </span>
<span id="cb185-31"><a href="#cb185-31" aria-hidden="true" tabindex="-1"></a>                   estimate_TransWareUtil,</span>
<span id="cb185-32"><a href="#cb185-32" aria-hidden="true" tabindex="-1"></a>   <span class="at">estimate_prvt_svcs =</span> estimate_Retail <span class="sc">+</span></span>
<span id="cb185-33"><a href="#cb185-33" aria-hidden="true" tabindex="-1"></a>                        estimate_EdHlthSoc <span class="sc">+</span> </span>
<span id="cb185-34"><a href="#cb185-34" aria-hidden="true" tabindex="-1"></a>                        estimate_ArtEntRecAcc <span class="sc">+</span> </span>
<span id="cb185-35"><a href="#cb185-35" aria-hidden="true" tabindex="-1"></a>                        estimate_OthSvcs,</span>
<span id="cb185-36"><a href="#cb185-36" aria-hidden="true" tabindex="-1"></a>   <span class="at">estimate_prdcr_svcs =</span> estimate_Info <span class="sc">+</span></span>
<span id="cb185-37"><a href="#cb185-37" aria-hidden="true" tabindex="-1"></a>                         estimate_FinInsRE <span class="sc">+</span></span>
<span id="cb185-38"><a href="#cb185-38" aria-hidden="true" tabindex="-1"></a>                         estimate_Prof)</span>
<span id="cb185-39"><a href="#cb185-39" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb185-40"><a href="#cb185-40" aria-hidden="true" tabindex="-1"></a><span class="do">## Check sums</span></span>
<span id="cb185-41"><a href="#cb185-41" aria-hidden="true" tabindex="-1"></a>counties_industry_wide <span class="ot">&lt;-</span> counties_industry_wide <span class="sc">%&gt;%</span></span>
<span id="cb185-42"><a href="#cb185-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">check_industry_sums =</span> estimate_AgForFishHuntMin <span class="sc">+</span> </span>
<span id="cb185-43"><a href="#cb185-43" aria-hidden="true" tabindex="-1"></a>    estimate_TTUC <span class="sc">+</span> </span>
<span id="cb185-44"><a href="#cb185-44" aria-hidden="true" tabindex="-1"></a>    estimate_Manu <span class="sc">+</span> </span>
<span id="cb185-45"><a href="#cb185-45" aria-hidden="true" tabindex="-1"></a>    estimate_prvt_svcs <span class="sc">+</span> </span>
<span id="cb185-46"><a href="#cb185-46" aria-hidden="true" tabindex="-1"></a>    estimate_prdcr_svcs <span class="sc">+</span> </span>
<span id="cb185-47"><a href="#cb185-47" aria-hidden="true" tabindex="-1"></a>    estimate_PubAdmin)</span>
<span id="cb185-48"><a href="#cb185-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-49"><a href="#cb185-49" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(counties_industry_wide<span class="sc">$</span>check_industry_sums)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
     51    4564   10519   44385   28546 4489974 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>counties_industry_wide <span class="ot">&lt;-</span> counties_industry_wide <span class="sc">%&gt;%</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">check_industry_diff =</span> <span class="fu">ifelse</span>(estimate_civ_emp_pop_total <span class="sc">!=</span> </span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a>                                        check_industry_sums, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(counties_industry_wide<span class="sc">$</span>check_industry_diff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
      0       0       0       0       0       0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="do">## No sums differ from totals - drop check vars</span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a>counties_industry_wide <span class="ot">&lt;-</span> counties_industry_wide <span class="sc">%&gt;%</span></span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span><span class="fu">c</span>(estimate_Construct, estimate_Wholesale, estimate_TransWareUtil,</span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a>            estimate_Retail, estimate_EdHlthSoc, estimate_ArtEntRecAcc,</span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a>            estimate_OthSvcs, check_industry_sums, check_industry_diff))</span>
<span id="cb189-6"><a href="#cb189-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-7"><a href="#cb189-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out outlying areas</span></span>
<span id="cb189-8"><a href="#cb189-8" aria-hidden="true" tabindex="-1"></a>counties_industry_wide  <span class="ot">&lt;-</span> counties_industry_wide <span class="sc">%&gt;%</span></span>
<span id="cb189-9"><a href="#cb189-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">as.numeric</span>(<span class="fu">substr</span>(GEOID, <span class="dv">1</span>, <span class="dv">2</span>)) <span class="sc">&lt;=</span> <span class="dv">56</span>)</span>
<span id="cb189-10"><a href="#cb189-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-11"><a href="#cb189-11" aria-hidden="true" tabindex="-1"></a>check_industry_states <span class="ot">&lt;-</span> counties_industry_wide <span class="sc">%&gt;%</span></span>
<span id="cb189-12"><a href="#cb189-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">as.numeric</span>(<span class="fu">substr</span>(GEOID, <span class="dv">1</span>, <span class="dv">2</span>)) <span class="sc">&gt;</span> <span class="dv">56</span>)</span>
<span id="cb189-13"><a href="#cb189-13" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(check_industry_states)  <span class="do">## 0 obs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt; table of extent 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 &gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Run basic descriptives </span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(counties_industry_wide)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">counties_industry_wide</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">3143</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">26</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">24</td>
</tr>
<tr class="even">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">GEOID</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3143</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">NAME</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3143</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 25%">
<col style="width: 9%">
<col style="width: 12%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 2%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">estimate_civ_emp_pop_total</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">45136.72</td>
<td style="text-align: right;">146007.74</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">4540.5</td>
<td style="text-align: right;">10641</td>
<td style="text-align: right;">28852.5</td>
<td style="text-align: right;">4489974</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">estimate_AgForFishHuntMin</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">869.01</td>
<td style="text-align: right;">2116.80</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">272.5</td>
<td style="text-align: right;">482</td>
<td style="text-align: right;">838.0</td>
<td style="text-align: right;">57312</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">estimate_Manu</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4730.33</td>
<td style="text-align: right;">14813.50</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">444.5</td>
<td style="text-align: right;">1364</td>
<td style="text-align: right;">3904.5</td>
<td style="text-align: right;">483592</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">estimate_Info</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">972.42</td>
<td style="text-align: right;">4684.18</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">48.0</td>
<td style="text-align: right;">139</td>
<td style="text-align: right;">441.5</td>
<td style="text-align: right;">195741</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">estimate_FinInsRE</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3012.97</td>
<td style="text-align: right;">11151.98</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">172.0</td>
<td style="text-align: right;">451</td>
<td style="text-align: right;">1379.5</td>
<td style="text-align: right;">286163</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">estimate_Prof</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4868.13</td>
<td style="text-align: right;">19231.80</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">214.0</td>
<td style="text-align: right;">622</td>
<td style="text-align: right;">2096.5</td>
<td style="text-align: right;">551858</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">estimate_PubAdmin</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2238.00</td>
<td style="text-align: right;">6454.27</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">241.5</td>
<td style="text-align: right;">547</td>
<td style="text-align: right;">1495.0</td>
<td style="text-align: right;">152389</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">moe_civ_emp_pop_total</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">617.84</td>
<td style="text-align: right;">652.12</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">245.5</td>
<td style="text-align: right;">434</td>
<td style="text-align: right;">730.5</td>
<td style="text-align: right;">9471</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">moe_AgForFishHuntMin</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">165.04</td>
<td style="text-align: right;">142.72</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">88.0</td>
<td style="text-align: right;">131</td>
<td style="text-align: right;">192.0</td>
<td style="text-align: right;">2158</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">moe_Construct</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">264.00</td>
<td style="text-align: right;">290.78</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">99.0</td>
<td style="text-align: right;">177</td>
<td style="text-align: right;">316.0</td>
<td style="text-align: right;">3284</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">moe_Manu</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">323.18</td>
<td style="text-align: right;">340.14</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">118.0</td>
<td style="text-align: right;">229</td>
<td style="text-align: right;">404.5</td>
<td style="text-align: right;">4243</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">moe_Wholesale</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">161.54</td>
<td style="text-align: right;">203.50</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">50.0</td>
<td style="text-align: right;">97</td>
<td style="text-align: right;">186.0</td>
<td style="text-align: right;">2767</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">moe_Retail</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">352.43</td>
<td style="text-align: right;">398.24</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">122.0</td>
<td style="text-align: right;">231</td>
<td style="text-align: right;">419.0</td>
<td style="text-align: right;">5115</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">moe_TransWareUtil</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">223.90</td>
<td style="text-align: right;">259.26</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">83.0</td>
<td style="text-align: right;">148</td>
<td style="text-align: right;">261.0</td>
<td style="text-align: right;">3693</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">moe_Info</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">130.28</td>
<td style="text-align: right;">186.88</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">34.0</td>
<td style="text-align: right;">73</td>
<td style="text-align: right;">143.0</td>
<td style="text-align: right;">3372</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">moe_FinInsRE</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">232.18</td>
<td style="text-align: right;">314.52</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">67.0</td>
<td style="text-align: right;">130</td>
<td style="text-align: right;">252.0</td>
<td style="text-align: right;">3957</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">moe_Prof</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">293.14</td>
<td style="text-align: right;">403.22</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">80.0</td>
<td style="text-align: right;">159</td>
<td style="text-align: right;">324.0</td>
<td style="text-align: right;">4862</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">moe_EdHlthSoc</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">443.53</td>
<td style="text-align: right;">500.82</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">163.0</td>
<td style="text-align: right;">284</td>
<td style="text-align: right;">513.0</td>
<td style="text-align: right;">7669</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">moe_ArtEntRecAcc</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">322.19</td>
<td style="text-align: right;">401.88</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">100.0</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">375.5</td>
<td style="text-align: right;">5829</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">moe_OthSvcs</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">225.68</td>
<td style="text-align: right;">273.56</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">77.0</td>
<td style="text-align: right;">145</td>
<td style="text-align: right;">262.5</td>
<td style="text-align: right;">3938</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">moe_PubAdmin</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">225.61</td>
<td style="text-align: right;">248.45</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">82.5</td>
<td style="text-align: right;">146</td>
<td style="text-align: right;">263.0</td>
<td style="text-align: right;">2780</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">estimate_TTUC</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6303.85</td>
<td style="text-align: right;">21107.15</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">721.0</td>
<td style="text-align: right;">1600</td>
<td style="text-align: right;">4211.5</td>
<td style="text-align: right;">654298</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">estimate_prvt_svcs</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">22142.01</td>
<td style="text-align: right;">70481.44</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">2062.0</td>
<td style="text-align: right;">5053</td>
<td style="text-align: right;">14397.5</td>
<td style="text-align: right;">2143500</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">estimate_prdcr_svcs</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8853.52</td>
<td style="text-align: right;">34543.16</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">451.5</td>
<td style="text-align: right;">1222</td>
<td style="text-align: right;">3856.0</td>
<td style="text-align: right;">1033762</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Reorder vars</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>counties_industry_wide <span class="ot">&lt;-</span> counties_industry_wide <span class="sc">%&gt;%</span> </span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(estimate_TTUC<span class="sc">:</span>estimate_prdcr_svcs, <span class="at">.before =</span> estimate_PubAdmin)</span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(counties_industry_wide, <span class="st">"counties_industry_wide.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Rename variables so understandable</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>counties_unemploy <span class="ot">&lt;-</span> counties_unemploy <span class="sc">%&gt;%</span></span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">variable  =</span> <span class="fu">case_when</span>(</span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"DP03_0003"</span> <span class="sc">~</span> <span class="st">"civ_16plus_labfor"</span>,</span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"DP03_0004"</span> <span class="sc">~</span> <span class="st">"civ_16plus_in_labfor"</span>,</span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">==</span> <span class="st">"DP03_0005"</span> <span class="sc">~</span> <span class="st">"civ_16plus_unemp"</span>))</span>
<span id="cb193-7"><a href="#cb193-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-8"><a href="#cb193-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Pivot from long to wide</span></span>
<span id="cb193-9"><a href="#cb193-9" aria-hidden="true" tabindex="-1"></a>counties_unemploy_wide <span class="ot">&lt;-</span> counties_unemploy <span class="sc">%&gt;%</span></span>
<span id="cb193-10"><a href="#cb193-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb193-11"><a href="#cb193-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> variable,</span>
<span id="cb193-12"><a href="#cb193-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> <span class="fu">c</span>(estimate, moe))</span>
<span id="cb193-13"><a href="#cb193-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-14"><a href="#cb193-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Check sums</span></span>
<span id="cb193-15"><a href="#cb193-15" aria-hidden="true" tabindex="-1"></a>counties_unemploy_wide <span class="ot">&lt;-</span> counties_unemploy_wide <span class="sc">%&gt;%</span></span>
<span id="cb193-16"><a href="#cb193-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">check_unemploy_sums =</span> estimate_civ_16plus_in_labfor <span class="sc">+</span></span>
<span id="cb193-17"><a href="#cb193-17" aria-hidden="true" tabindex="-1"></a>                               estimate_civ_16plus_unemp)</span>
<span id="cb193-18"><a href="#cb193-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-19"><a href="#cb193-19" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(counties_unemploy_wide<span class="sc">$</span>check_unemploy_sums)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
     51    5043   11783   49196   31502 5070505 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>counties_unemploy_wide <span class="ot">&lt;-</span> counties_unemploy_wide <span class="sc">%&gt;%</span></span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">check_unemploy_diff =</span> <span class="fu">ifelse</span>(estimate_civ_16plus_labfor <span class="sc">!=</span> </span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a>                                        check_unemploy_sums, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-5"><a href="#cb195-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(counties_unemploy_wide<span class="sc">$</span>check_unemploy_diff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
      0       0       0       0       0       0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="do">## No sums differ from totals - drop check vars</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>counties_unemploy_wide <span class="ot">&lt;-</span> counties_unemploy_wide <span class="sc">%&gt;%</span></span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span><span class="fu">c</span>(check_unemploy_sums, check_unemploy_diff))</span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out outlying areas</span></span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a>counties_unemploy_wide  <span class="ot">&lt;-</span> counties_unemploy_wide <span class="sc">%&gt;%</span></span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">as.numeric</span>(<span class="fu">substr</span>(GEOID, <span class="dv">1</span>, <span class="dv">2</span>)) <span class="sc">&lt;=</span> <span class="dv">56</span>)</span>
<span id="cb197-8"><a href="#cb197-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-9"><a href="#cb197-9" aria-hidden="true" tabindex="-1"></a>check_unemploy_states <span class="ot">&lt;-</span> counties_unemploy_wide <span class="sc">%&gt;%</span></span>
<span id="cb197-10"><a href="#cb197-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">as.numeric</span>(<span class="fu">substr</span>(GEOID, <span class="dv">1</span>, <span class="dv">2</span>)) <span class="sc">&gt;</span> <span class="dv">56</span>)</span>
<span id="cb197-11"><a href="#cb197-11" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(check_unemploy_states)  <span class="do">## 0 obs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt; table of extent 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 &gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Run basic descriptives </span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(counties_unemploy_wide)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">counties_unemploy_wide</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">3143</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">GEOID</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3143</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">NAME</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3143</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 27%">
<col style="width: 9%">
<col style="width: 12%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 2%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">estimate_civ_16plus_labfor</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">49988.51</td>
<td style="text-align: right;">163253.97</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">4962.0</td>
<td style="text-align: right;">11790</td>
<td style="text-align: right;">31905.5</td>
<td style="text-align: right;">5070505</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">estimate_civ_16plus_in_labfor</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">45136.72</td>
<td style="text-align: right;">146007.74</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">4540.5</td>
<td style="text-align: right;">10641</td>
<td style="text-align: right;">28852.5</td>
<td style="text-align: right;">4489974</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">estimate_civ_16plus_unemp</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4851.79</td>
<td style="text-align: right;">17623.88</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">411.0</td>
<td style="text-align: right;">1130</td>
<td style="text-align: right;">3020.5</td>
<td style="text-align: right;">580531</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">moe_civ_16plus_labfor</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">587.36</td>
<td style="text-align: right;">613.20</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">235.5</td>
<td style="text-align: right;">410</td>
<td style="text-align: right;">695.5</td>
<td style="text-align: right;">8409</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">moe_civ_16plus_in_labfor</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">617.84</td>
<td style="text-align: right;">652.12</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">245.5</td>
<td style="text-align: right;">434</td>
<td style="text-align: right;">730.5</td>
<td style="text-align: right;">9471</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">moe_civ_16plus_unemp</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">334.86</td>
<td style="text-align: right;">393.80</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">116.0</td>
<td style="text-align: right;">222</td>
<td style="text-align: right;">392.0</td>
<td style="text-align: right;">5696</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(counties_unemploy_wide, <span class="st">"counties_unemploy_wide.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out outlying areas</span></span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a>counties_sf  <span class="ot">&lt;-</span> counties_sf <span class="sc">%&gt;%</span></span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">as.numeric</span>(<span class="fu">substr</span>(GEOID, <span class="dv">1</span>, <span class="dv">2</span>)) <span class="sc">&lt;=</span> <span class="dv">56</span>)</span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-5"><a href="#cb201-5" aria-hidden="true" tabindex="-1"></a>check_counties_sf <span class="ot">&lt;-</span> counties_sf <span class="sc">%&gt;%</span></span>
<span id="cb201-6"><a href="#cb201-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">as.numeric</span>(<span class="fu">substr</span>(GEOID, <span class="dv">1</span>, <span class="dv">2</span>)) <span class="sc">&gt;</span> <span class="dv">56</span>)</span>
<span id="cb201-7"><a href="#cb201-7" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(check_counties_sf)  <span class="do">## 0 obs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt; table of extent 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 x 0 &gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check geometries</span></span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(<span class="fu">st_is_valid</span>(counties_sf))  <span class="do">## TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">st_is_empty</span>(counties_sf))  <span class="do">## FALSE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_bbox</span>(counties_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      xmin       ymin       xmax       ymax 
-179.23109   18.86546  179.85968   71.44106 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="co">#       xmin       ymin       xmax       ymax </span></span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a><span class="co"># -179.23109   18.86546  179.85968   71.44106 </span></span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(counties_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: plotting the first 10 out of 17 attributes; use max.plot = 17 to plot
all</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="HS-Opp-Structures_files/figure-html/Drop%20outlying%20areas%20in%20sf,%20check%20geometries,%20merge%20Census%20dataframes-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Join Census df</span></span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a>counties2013a <span class="ot">&lt;-</span> <span class="fu">left_join</span>(counties_ed_wide, </span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a>                           counties_industry_wide, <span class="at">by =</span> <span class="st">"GEOID"</span>)</span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true" tabindex="-1"></a>counties2013b <span class="ot">&lt;-</span> <span class="fu">left_join</span>(counties2013a, </span>
<span id="cb211-5"><a href="#cb211-5" aria-hidden="true" tabindex="-1"></a>                           counties_IPR_wide, <span class="at">by =</span> <span class="st">"GEOID"</span>)</span>
<span id="cb211-6"><a href="#cb211-6" aria-hidden="true" tabindex="-1"></a>counties2013c <span class="ot">&lt;-</span> <span class="fu">left_join</span>(counties2013b, </span>
<span id="cb211-7"><a href="#cb211-7" aria-hidden="true" tabindex="-1"></a>                           counties_medinc_wide, <span class="at">by =</span> <span class="st">"GEOID"</span>)</span>
<span id="cb211-8"><a href="#cb211-8" aria-hidden="true" tabindex="-1"></a>counties2013d <span class="ot">&lt;-</span> <span class="fu">left_join</span>(counties2013c, </span>
<span id="cb211-9"><a href="#cb211-9" aria-hidden="true" tabindex="-1"></a>                           counties_poverty_wide, <span class="at">by =</span> <span class="st">"GEOID"</span>)</span>
<span id="cb211-10"><a href="#cb211-10" aria-hidden="true" tabindex="-1"></a>counties2013e <span class="ot">&lt;-</span> <span class="fu">left_join</span>(counties2013d, </span>
<span id="cb211-11"><a href="#cb211-11" aria-hidden="true" tabindex="-1"></a>                           counties_race_wide, <span class="at">by =</span> <span class="st">"GEOID"</span>)</span>
<span id="cb211-12"><a href="#cb211-12" aria-hidden="true" tabindex="-1"></a>counties2013f <span class="ot">&lt;-</span> <span class="fu">left_join</span>(counties2013e, </span>
<span id="cb211-13"><a href="#cb211-13" aria-hidden="true" tabindex="-1"></a>                           counties_unemploy_wide, <span class="at">by =</span> <span class="st">"GEOID"</span>)</span>
<span id="cb211-14"><a href="#cb211-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-15"><a href="#cb211-15" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(counties2013f, <span class="st">"counties2013f.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="do">##### Separately, shapefiles do not appear to be available for 2013. Downloaded  </span></span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a><span class="do">###  2015-16 from </span></span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a><span class="co">#    https://data-nces.opendata.arcgis.com/datasets/741214a4a1824b018506fd140599e57f_0/explore</span></span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true" tabindex="-1"></a><span class="do">### 2009-10 SY</span></span>
<span id="cb212-6"><a href="#cb212-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop outlying areas</span></span>
<span id="cb212-7"><a href="#cb212-7" aria-hidden="true" tabindex="-1"></a>CCD2009_dir_statesonly <span class="ot">&lt;-</span> CCD2009_dir <span class="sc">%&gt;%</span></span>
<span id="cb212-8"><a href="#cb212-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(fips <span class="sc">&lt;=</span> <span class="dv">56</span>)  </span>
<span id="cb212-9"><a href="#cb212-9" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(CCD2009_dir_statesonly<span class="sc">$</span>fips)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    1     2     4     5     6     8     9    10    11    12    13    15    16 
 1628   516  2368  1148 10290  1818  1178   247   241  4255  2608   291   755 
   17    18    19    20    21    22    23    24    25    26    27    28    29 
 4456  1990  1502  1466  1565  1678   670  1475  1887  4201  2491  1097  2457 
   30    31    32    33    34    35    36    37    38    39    40    41    42 
  840  1145   663   494  2632   866  4769  2614   533  3936  1815  1329  3303 
   44    45    46    47    48    49    50    51    53    54    55    56 
  332  1230   731  1791  9252  1066   328  2186  2368   771  2300   366 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create list of vars to keep</span></span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a>CCDdir_col_keep <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"year"</span>, <span class="st">"ncessch"</span>, <span class="st">"school_id"</span>, <span class="st">"school_name"</span>, <span class="st">"leaid"</span>, </span>
<span id="cb214-3"><a href="#cb214-3" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"lea_name"</span>, <span class="st">"fips"</span>, <span class="st">"latitude"</span>, <span class="st">"longitude"</span>, </span>
<span id="cb214-4"><a href="#cb214-4" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"urban_centric_locale"</span>, <span class="st">"county_code"</span>, <span class="st">"school_type"</span>, </span>
<span id="cb214-5"><a href="#cb214-5" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"school_status"</span>, <span class="st">"charter"</span>, <span class="st">"magnet"</span>, <span class="st">"virtual"</span>, </span>
<span id="cb214-6"><a href="#cb214-6" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"enrollment"</span>, <span class="st">"ncessch_num"</span>)</span>
<span id="cb214-7"><a href="#cb214-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-8"><a href="#cb214-8" aria-hidden="true" tabindex="-1"></a><span class="do">##### Per CCD 2009 codebook: </span></span>
<span id="cb214-9"><a href="#cb214-9" aria-hidden="true" tabindex="-1"></a><span class="do">###  TYPE09 1 = reg, 2 = spec ed, 3 = voc ed, 4 = alt, 5 = reportable program</span></span>
<span id="cb214-10"><a href="#cb214-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   STATUS09 1 = open at last report/currently open,</span></span>
<span id="cb214-11"><a href="#cb214-11" aria-hidden="true" tabindex="-1"></a><span class="co">#            2 = closed</span></span>
<span id="cb214-12"><a href="#cb214-12" aria-hidden="true" tabindex="-1"></a><span class="co">#            3 = opened</span></span>
<span id="cb214-13"><a href="#cb214-13" aria-hidden="true" tabindex="-1"></a><span class="co">#            4 = operation last report but not on CCD list at time</span></span>
<span id="cb214-14"><a href="#cb214-14" aria-hidden="true" tabindex="-1"></a><span class="co">#            5 = listed last year as with diff LEA</span></span>
<span id="cb214-15"><a href="#cb214-15" aria-hidden="true" tabindex="-1"></a><span class="co">#            6 = closed</span></span>
<span id="cb214-16"><a href="#cb214-16" aria-hidden="true" tabindex="-1"></a><span class="co">#            7 = scheduled to be operational</span></span>
<span id="cb214-17"><a href="#cb214-17" aria-hidden="true" tabindex="-1"></a><span class="co">#            8 = reopened</span></span>
<span id="cb214-18"><a href="#cb214-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-19"><a href="#cb214-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Retain only needed vars</span></span>
<span id="cb214-20"><a href="#cb214-20" aria-hidden="true" tabindex="-1"></a>CCD2009_dir_short <span class="ot">&lt;-</span> <span class="fu">select</span>(CCD2009_dir_statesonly, <span class="sc">!!!</span>CCDdir_col_keep)</span>
<span id="cb214-21"><a href="#cb214-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-22"><a href="#cb214-22" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(CCD2009_dir_short, <span class="st">"CCD2009_dir_short.rds"</span>)</span>
<span id="cb214-23"><a href="#cb214-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-24"><a href="#cb214-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-25"><a href="#cb214-25" aria-hidden="true" tabindex="-1"></a><span class="do">### 2010-11 SY</span></span>
<span id="cb214-26"><a href="#cb214-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop outlying areas</span></span>
<span id="cb214-27"><a href="#cb214-27" aria-hidden="true" tabindex="-1"></a>CCD2010_dir_statesonly <span class="ot">&lt;-</span> CCD2010_dir <span class="sc">%&gt;%</span></span>
<span id="cb214-28"><a href="#cb214-28" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(fips <span class="sc">&lt;=</span> <span class="dv">56</span>)  </span>
<span id="cb214-29"><a href="#cb214-29" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(CCD2010_dir_statesonly<span class="sc">$</span>fips)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    1     2     4     5     6     8     9    10    11    12    13    15    16 
 1615   518  2431  1136 10343  1835  1184   225   247  4289  2542   290   760 
   17    18    19    20    21    22    23    24    25    26    27    28    29 
 4444  1997  1490  1490  1577  1509   657  1457  1859  4159  2467  1115  2459 
   30    31    32    33    34    35    36    37    38    39    40    41    42 
  833  1131   677   484  2646   875  4803  2611   532  3907  1810  1313  3270 
   44    45    46    47    48    49    50    51    53    54    55    56 
  325  1228   725  1803  9348  1076   324  2211  2354   765  2282   365 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep only needed vars</span></span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a>CCD2010_dir_short <span class="ot">&lt;-</span> <span class="fu">select</span>(CCD2010_dir_statesonly, <span class="sc">!!!</span>CCDdir_col_keep)</span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(CCD2010_dir_short, <span class="st">"CCD2010_dir_short.rds"</span>)</span>
<span id="cb216-5"><a href="#cb216-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-6"><a href="#cb216-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-7"><a href="#cb216-7" aria-hidden="true" tabindex="-1"></a><span class="do">### 2011-12SY</span></span>
<span id="cb216-8"><a href="#cb216-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop outlying areas</span></span>
<span id="cb216-9"><a href="#cb216-9" aria-hidden="true" tabindex="-1"></a>CCD2011_dir_statesonly <span class="ot">&lt;-</span> CCD2011_dir <span class="sc">%&gt;%</span></span>
<span id="cb216-10"><a href="#cb216-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(fips <span class="sc">&lt;=</span> <span class="dv">56</span>)  </span>
<span id="cb216-11"><a href="#cb216-11" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(CCD2011_dir_statesonly<span class="sc">$</span>fips)  <span class="do">## 101,501 obs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    1     2     4     5     6     8     9    10    11    12    13    15    16 
 1621   519  2462  1122 10351  1843  1174   224   252  4426  2541   289   775 
   17    18    19    20    21    22    23    24    25    26    27    28    29 
 4406  1970  1453  1396  1571  1486   644  1461  1872  3964  2468  1088  2434 
   30    31    32    33    34    35    36    37    38    39    40    41    42 
  831  1115   683   491  2650   868  4820  2622   532  3844  1809  1304  3290 
   44    45    46    47    48    49    50    51    53    54    55    56 
  319  1245   715  1816  9340  1068   320  2192  2377   772  2296   370 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep only needed vars</span></span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a>CCD2011_dir_short <span class="ot">&lt;-</span> <span class="fu">select</span>(CCD2011_dir_statesonly, <span class="sc">!!!</span>CCDdir_col_keep)</span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(CCD2011_dir_short, <span class="st">"CCD2011_dir_short.rds"</span>)</span>
<span id="cb218-5"><a href="#cb218-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-6"><a href="#cb218-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-7"><a href="#cb218-7" aria-hidden="true" tabindex="-1"></a><span class="do">### 2012-13 SY</span></span>
<span id="cb218-8"><a href="#cb218-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop outlying areas</span></span>
<span id="cb218-9"><a href="#cb218-9" aria-hidden="true" tabindex="-1"></a>CCD2012_dir_statesonly <span class="ot">&lt;-</span> CCD2012_dir <span class="sc">%&gt;%</span></span>
<span id="cb218-10"><a href="#cb218-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(fips <span class="sc">&lt;=</span> <span class="dv">56</span>)  </span>
<span id="cb218-11"><a href="#cb218-11" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(CCD2012_dir_statesonly<span class="sc">$</span>fips)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    1     2     4     5     6     8     9    10    11    12    13    15    16 
 1637   522  2430  1129 10527  1844  1169   228   247  4388  2427   288   786 
   17    18    19    20    21    22    23    24    25    26    27    28    29 
 4375  1953  1429  1367  1583  1457   626  1456  1869  3670  2464  1078  2430 
   30    31    32    33    34    35    36    37    38    39    40    41    42 
  832  1103   686   487  2630   881  4823  2644   534  3813  1796  1276  3229 
   44    45    46    47    48    49    50    51    53    54    55    56 
  311  1254   716  1835  9287  1047   320  2203  2416   767  2285   365 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep only needed vars</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>CCD2012_dir_short <span class="ot">&lt;-</span> <span class="fu">select</span>(CCD2012_dir_statesonly, <span class="sc">!!!</span>CCDdir_col_keep)</span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(CCD2012_dir_short, <span class="st">"CCD2012_dir_short.rds"</span>)</span>
<span id="cb220-5"><a href="#cb220-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-6"><a href="#cb220-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-7"><a href="#cb220-7" aria-hidden="true" tabindex="-1"></a><span class="do">##### Merge CCD Directory Files</span></span>
<span id="cb220-8"><a href="#cb220-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-9"><a href="#cb220-9" aria-hidden="true" tabindex="-1"></a><span class="do">##### Per E. Christopher, NCES, “HSLS:09 is nationally representative of schools </span></span>
<span id="cb220-10"><a href="#cb220-10" aria-hidden="true" tabindex="-1"></a><span class="do">###  in 2009 with 9th grades." email, 2/23/24 - So, merge to keep only schools </span></span>
<span id="cb220-11"><a href="#cb220-11" aria-hidden="true" tabindex="-1"></a><span class="co">#    that were in CCD during 2009 and each of the following years. </span></span>
<span id="cb220-12"><a href="#cb220-12" aria-hidden="true" tabindex="-1"></a><span class="co">#    Also, in UI CCD files, year as separate var. Add suffix to distinguish years. </span></span>
<span id="cb220-13"><a href="#cb220-13" aria-hidden="true" tabindex="-1"></a><span class="co">#    Left join uses a common key, retains all rows fm left df, incl matching rows</span></span>
<span id="cb220-14"><a href="#cb220-14" aria-hidden="true" tabindex="-1"></a><span class="co">#    fm right df. Rows fm left w/ no match on right will have NAs. </span></span>
<span id="cb220-15"><a href="#cb220-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-16"><a href="#cb220-16" aria-hidden="true" tabindex="-1"></a><span class="do">### Add year as variable suffix to id changes over time, exclude ncessch,  </span></span>
<span id="cb220-17"><a href="#cb220-17" aria-hidden="true" tabindex="-1"></a><span class="do">## school_id, school_name, leaid, lea_name, latitude, longitude, ncessch_num</span></span>
<span id="cb220-18"><a href="#cb220-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-19"><a href="#cb220-19" aria-hidden="true" tabindex="-1"></a>exclude_ccd_suffix <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ncessch"</span>, <span class="st">"school_id"</span>, <span class="st">"school_name"</span>, <span class="st">"leaid"</span>,</span>
<span id="cb220-20"><a href="#cb220-20" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"lea_name"</span>, <span class="st">"latitude"</span>, <span class="st">"longitude"</span>, </span>
<span id="cb220-21"><a href="#cb220-21" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"ncessch_num"</span>) </span>
<span id="cb220-22"><a href="#cb220-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-23"><a href="#cb220-23" aria-hidden="true" tabindex="-1"></a>CCD2009_dir_addyr <span class="ot">&lt;-</span> CCD2009_dir_short <span class="sc">%&gt;%</span></span>
<span id="cb220-24"><a href="#cb220-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"09"</span>), <span class="sc">-</span><span class="fu">all_of</span>(exclude_ccd_suffix))</span>
<span id="cb220-25"><a href="#cb220-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-26"><a href="#cb220-26" aria-hidden="true" tabindex="-1"></a>CCD2010_dir_addyr <span class="ot">&lt;-</span> CCD2010_dir_short <span class="sc">%&gt;%</span></span>
<span id="cb220-27"><a href="#cb220-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"10"</span>), <span class="sc">-</span><span class="fu">all_of</span>(exclude_ccd_suffix))</span>
<span id="cb220-28"><a href="#cb220-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-29"><a href="#cb220-29" aria-hidden="true" tabindex="-1"></a>CCD2011_dir_addyr <span class="ot">&lt;-</span> CCD2011_dir_short <span class="sc">%&gt;%</span></span>
<span id="cb220-30"><a href="#cb220-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"11"</span>), <span class="sc">-</span><span class="fu">all_of</span>(exclude_ccd_suffix))</span>
<span id="cb220-31"><a href="#cb220-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-32"><a href="#cb220-32" aria-hidden="true" tabindex="-1"></a>CCD2012_dir_addyr <span class="ot">&lt;-</span> CCD2012_dir_short <span class="sc">%&gt;%</span></span>
<span id="cb220-33"><a href="#cb220-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"12"</span>), <span class="sc">-</span><span class="fu">all_of</span>(exclude_ccd_suffix))</span>
<span id="cb220-34"><a href="#cb220-34" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb220-35"><a href="#cb220-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-36"><a href="#cb220-36" aria-hidden="true" tabindex="-1"></a><span class="do">## Create one file of CCD dir data across all years, to check changes in locale</span></span>
<span id="cb220-37"><a href="#cb220-37" aria-hidden="true" tabindex="-1"></a>CCD2009_11_merge <span class="ot">&lt;-</span> <span class="fu">left_join</span>(CCD2009_dir_addyr, CCD2010_dir_addyr, </span>
<span id="cb220-38"><a href="#cb220-38" aria-hidden="true" tabindex="-1"></a>                              <span class="at">by =</span> <span class="st">"ncessch_num"</span>)</span>
<span id="cb220-39"><a href="#cb220-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-40"><a href="#cb220-40" aria-hidden="true" tabindex="-1"></a>CCD2009_12_merge <span class="ot">&lt;-</span> <span class="fu">left_join</span>(CCD2009_11_merge, CCD2011_dir_addyr, </span>
<span id="cb220-41"><a href="#cb220-41" aria-hidden="true" tabindex="-1"></a>                              <span class="at">by =</span> <span class="st">"ncessch_num"</span>)</span>
<span id="cb220-42"><a href="#cb220-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-43"><a href="#cb220-43" aria-hidden="true" tabindex="-1"></a>CCD2009_13_merge <span class="ot">&lt;-</span> <span class="fu">left_join</span>(CCD2009_12_merge, CCD2012_dir_addyr, </span>
<span id="cb220-44"><a href="#cb220-44" aria-hidden="true" tabindex="-1"></a>                              <span class="at">by =</span> <span class="st">"ncessch_num"</span>)</span>
<span id="cb220-45"><a href="#cb220-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-46"><a href="#cb220-46" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(CCD2009_13_merge, <span class="st">"CCD2009_13_merge.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="do">###??? This code chunk does not run properly due to unresolved errors in join </span></span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a><span class="do">##### UI CCD files incl FIPS code county_code) but drop leading zeros - Census </span></span>
<span id="cb221-4"><a href="#cb221-4" aria-hidden="true" tabindex="-1"></a><span class="do">###  files do not. Use sprintf/"%05d" to pad FIPS, for merge</span></span>
<span id="cb221-5"><a href="#cb221-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-6"><a href="#cb221-6" aria-hidden="true" tabindex="-1"></a>CCD2009_13_merge<span class="sc">$</span>county_code09 <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%05s"</span>, CCD2009_13_merge<span class="sc">$</span>county_code09)</span>
<span id="cb221-7"><a href="#cb221-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-8"><a href="#cb221-8" aria-hidden="true" tabindex="-1"></a><span class="fu">nchar</span>(CCD2009_13_merge<span class="sc">$</span>county_code09)  <span class="do">## Now 5 characters</span></span>
<span id="cb221-9"><a href="#cb221-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-10"><a href="#cb221-10" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(CCD2009_13_merge, <span class="st">"CCD2009_13_merge.rds"</span>)</span>
<span id="cb221-11"><a href="#cb221-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-12"><a href="#cb221-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-13"><a href="#cb221-13" aria-hidden="true" tabindex="-1"></a><span class="do">###??? Join Census and CCD dfs, based on 2009 county code b/c HSLS data are </span></span>
<span id="cb221-14"><a href="#cb221-14" aria-hidden="true" tabindex="-1"></a><span class="do">##  generalizable as of freshman class in 2009? What would this mean for id-ing</span></span>
<span id="cb221-15"><a href="#cb221-15" aria-hidden="true" tabindex="-1"></a><span class="do">##  counties that changed categorization in 2010? Captured at school-level in </span></span>
<span id="cb221-16"><a href="#cb221-16" aria-hidden="true" tabindex="-1"></a><span class="do">##  HSLS...</span></span>
<span id="cb221-17"><a href="#cb221-17" aria-hidden="true" tabindex="-1"></a>ccd_counties_df <span class="ot">&lt;-</span> <span class="fu">left_join</span>(CCD2009_13_merge, counties2013f, </span>
<span id="cb221-18"><a href="#cb221-18" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">c</span>(<span class="st">"county_code09"</span> <span class="ot">=</span> <span class="st">"GEOID"</span>))</span>
<span id="cb221-19"><a href="#cb221-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-20"><a href="#cb221-20" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(ccd_counties_df, <span class="st">"ccd_counties_df"</span>, <span class="at">row.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb221-21"><a href="#cb221-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-22"><a href="#cb221-22" aria-hidden="true" tabindex="-1"></a><span class="do">### Add CRS to df</span></span>
<span id="cb221-23"><a href="#cb221-23" aria-hidden="true" tabindex="-1"></a><span class="do">## counties_ccd_crs &lt;- st_as_sf(ccd_counties_df, </span></span>
<span id="cb221-24"><a href="#cb221-24" aria-hidden="true" tabindex="-1"></a><span class="co">#                            coords = c("latitude.x", "longitude.x"), crs = 4326)</span></span>
<span id="cb221-25"><a href="#cb221-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Error message - some cases missing coordinates in CCD file</span></span>
<span id="cb221-26"><a href="#cb221-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-27"><a href="#cb221-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Check CCD merge</span></span>
<span id="cb221-28"><a href="#cb221-28" aria-hidden="true" tabindex="-1"></a>check_lat_long <span class="ot">&lt;-</span> ccd_counties_df <span class="sc">%&gt;%</span></span>
<span id="cb221-29"><a href="#cb221-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(fips09, county_code09, urban_centric_locale09, </span>
<span id="cb221-30"><a href="#cb221-30" aria-hidden="true" tabindex="-1"></a>         ncessch.x, ncessch.x.x,</span>
<span id="cb221-31"><a href="#cb221-31" aria-hidden="true" tabindex="-1"></a>         ncessch.y, ncessch.y.y,</span>
<span id="cb221-32"><a href="#cb221-32" aria-hidden="true" tabindex="-1"></a>         latitude.x, longitude.x,</span>
<span id="cb221-33"><a href="#cb221-33" aria-hidden="true" tabindex="-1"></a>         latitude.x.x, longitude.x.x,</span>
<span id="cb221-34"><a href="#cb221-34" aria-hidden="true" tabindex="-1"></a>         latitude.y, longitude.y,</span>
<span id="cb221-35"><a href="#cb221-35" aria-hidden="true" tabindex="-1"></a>         latitude.y.y, longitude.y.y)</span>
<span id="cb221-36"><a href="#cb221-36" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span>(check_lat_long)</span>
<span id="cb221-37"><a href="#cb221-37" aria-hidden="true" tabindex="-1"></a><span class="do">###??? Some schools no census data?</span></span>
<span id="cb221-38"><a href="#cb221-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-39"><a href="#cb221-39" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">subset</span>(check_lat_long, <span class="fu">is.na</span>(latitude.x), <span class="at">select =</span> <span class="fu">c</span>(fips09, county_code09)))</span>
<span id="cb221-40"><a href="#cb221-40" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sum</span>(<span class="fu">is.na</span>(check_lat_long<span class="sc">$</span>latitude.x)))</span>
<span id="cb221-41"><a href="#cb221-41" aria-hidden="true" tabindex="-1"></a><span class="do">###??? Visual inspection - no apparent pattern and just 82 cases</span></span>
<span id="cb221-42"><a href="#cb221-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-43"><a href="#cb221-43" aria-hidden="true" tabindex="-1"></a><span class="do">## Omit cases with missing lat data</span></span>
<span id="cb221-44"><a href="#cb221-44" aria-hidden="true" tabindex="-1"></a>ccd_counties_df <span class="ot">&lt;-</span> <span class="fu">subset</span>(ccd_counties_df, <span class="sc">!</span><span class="fu">is.na</span>(latitude.x))</span>
<span id="cb221-45"><a href="#cb221-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-46"><a href="#cb221-46" aria-hidden="true" tabindex="-1"></a><span class="do">## Project, add CRS to df, first to 4326, then to match counties_sf</span></span>
<span id="cb221-47"><a href="#cb221-47" aria-hidden="true" tabindex="-1"></a>ccd_counties_proj <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(</span>
<span id="cb221-48"><a href="#cb221-48" aria-hidden="true" tabindex="-1"></a>  ccd_counties_df, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"latitude.x"</span>, <span class="st">"longitude.x"</span>), <span class="at">crs =</span> <span class="dv">4326</span>) <span class="sc">%&gt;%</span></span>
<span id="cb221-49"><a href="#cb221-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(., <span class="fu">st_crs</span>(counties_sf)) <span class="sc">%&gt;%</span></span>
<span id="cb221-50"><a href="#cb221-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(., geometry, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb221-51"><a href="#cb221-51" aria-hidden="true" tabindex="-1"></a><span class="do">##??? Waring, bb potentially invalid range lat/long but falls w/i +/- 90/180</span></span>
<span id="cb221-52"><a href="#cb221-52" aria-hidden="true" tabindex="-1"></a>                            </span>
<span id="cb221-53"><a href="#cb221-53" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(ccd_counties_proj)  <span class="do">## 4269</span></span>
<span id="cb221-54"><a href="#cb221-54" aria-hidden="true" tabindex="-1"></a><span class="fu">st_bbox</span>(ccd_counties_proj)</span>
<span id="cb221-55"><a href="#cb221-55" aria-hidden="true" tabindex="-1"></a><span class="do">###??? bb doesn't match counties_sf</span></span>
<span id="cb221-56"><a href="#cb221-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-57"><a href="#cb221-57" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(<span class="fu">st_crs</span>(ccd_counties_proj), <span class="fu">st_crs</span>(counties_sf)) </span>
<span id="cb221-58"><a href="#cb221-58" aria-hidden="true" tabindex="-1"></a><span class="co"># TRUE</span></span>
<span id="cb221-59"><a href="#cb221-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-60"><a href="#cb221-60" aria-hidden="true" tabindex="-1"></a><span class="do">## Check</span></span>
<span id="cb221-61"><a href="#cb221-61" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(counties_cenccd_proj)</span>
<span id="cb221-62"><a href="#cb221-62" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(counties_cenccd_proj)</span>
<span id="cb221-63"><a href="#cb221-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-64"><a href="#cb221-64" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(<span class="fu">st_is_valid</span>(ccd_counties_proj))  <span class="do">## TRUE</span></span>
<span id="cb221-65"><a href="#cb221-65" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">st_is_empty</span>(ccd_counties_proj))  <span class="do">## FALSE</span></span>
<span id="cb221-66"><a href="#cb221-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-67"><a href="#cb221-67" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(ccd_counties_proj, <span class="st">"ccd_counties_proj.rds"</span>)</span>
<span id="cb221-68"><a href="#cb221-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-69"><a href="#cb221-69" aria-hidden="true" tabindex="-1"></a><span class="do">## Join the projected df w/ the county shapefile</span></span>
<span id="cb221-70"><a href="#cb221-70" aria-hidden="true" tabindex="-1"></a>schools_wi_counties <span class="ot">&lt;-</span> <span class="fu">st_join</span>(ccd_counties_proj, counties_sf, <span class="at">join =</span> st_within)</span>
<span id="cb221-71"><a href="#cb221-71" aria-hidden="true" tabindex="-1"></a><span class="do">###??? Invalid bounding box warning</span></span>
<span id="cb221-72"><a href="#cb221-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-73"><a href="#cb221-73" aria-hidden="true" tabindex="-1"></a><span class="do">## Map some vars</span></span>
<span id="cb221-74"><a href="#cb221-74" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb221-75"><a href="#cb221-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> schools_wi_counties, <span class="fu">aes</span>(<span class="at">fill =</span> estimate_somecoll_assoc)) <span class="sc">+</span></span>
<span id="cb221-76"><a href="#cb221-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>() <span class="sc">+</span>  </span>
<span id="cb221-77"><a href="#cb221-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Spatial Distribution of ed level - some coll/associate"</span>)</span>
<span id="cb221-78"><a href="#cb221-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-79"><a href="#cb221-79" aria-hidden="true" tabindex="-1"></a><span class="do">###??? Total disaster</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="do">###??? This code chunk does not run properly due to unresolved errors in prior</span></span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Check geometry</span></span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a><span class="fu">st_geometry_type</span>(ccd_counties_proj)</span>
<span id="cb222-5"><a href="#cb222-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Point</span></span>
<span id="cb222-6"><a href="#cb222-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-7"><a href="#cb222-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Use Ripley's K to test spatial dist of pt patterns</span></span>
<span id="cb222-8"><a href="#cb222-8" aria-hidden="true" tabindex="-1"></a>kf.env <span class="ot">&lt;-</span> <span class="fu">envelope</span>(</span>
<span id="cb222-9"><a href="#cb222-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.ppp</span>(ccd_counties_proj<span class="sc">$</span>estimate_IPR_under50),  </span>
<span id="cb222-10"><a href="#cb222-10" aria-hidden="true" tabindex="-1"></a>  <span class="do">## convert spatial obj to pt pattern obj</span></span>
<span id="cb222-11"><a href="#cb222-11" aria-hidden="true" tabindex="-1"></a>  Kest,                       </span>
<span id="cb222-12"><a href="#cb222-12" aria-hidden="true" tabindex="-1"></a>  <span class="do">## tests whether points randomly distributed</span></span>
<span id="cb222-13"><a href="#cb222-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">correction =</span> <span class="st">"translation"</span>,  </span>
<span id="cb222-14"><a href="#cb222-14" aria-hidden="true" tabindex="-1"></a>  <span class="do">## method for computing envelope, adjust for edge effects</span></span>
<span id="cb222-15"><a href="#cb222-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsim=</span> <span class="dv">1000</span>, </span>
<span id="cb222-16"><a href="#cb222-16" aria-hidden="true" tabindex="-1"></a>  <span class="do">## # of simulations</span></span>
<span id="cb222-17"><a href="#cb222-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">envelope =</span> <span class="cn">TRUE</span>, </span>
<span id="cb222-18"><a href="#cb222-18" aria-hidden="true" tabindex="-1"></a>  <span class="do">## range of values expected uner null hypoth spatial randomness</span></span>
<span id="cb222-19"><a href="#cb222-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb222-20"><a href="#cb222-20" aria-hidden="true" tabindex="-1"></a><span class="do">## don't print progress messages</span></span>
<span id="cb222-21"><a href="#cb222-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-22"><a href="#cb222-22" aria-hidden="true" tabindex="-1"></a><span class="do">###??? Error message, can't interpret X as point pattern - so I think I haven't </span></span>
<span id="cb222-23"><a href="#cb222-23" aria-hidden="true" tabindex="-1"></a><span class="do">### properly projected my data?</span></span>
<span id="cb222-24"><a href="#cb222-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-25"><a href="#cb222-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-26"><a href="#cb222-26" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimate spatial weights matrix using adaptive bandwith - adjusts</span></span>
<span id="cb222-27"><a href="#cb222-27" aria-hidden="true" tabindex="-1"></a><span class="do">##  based on local properties of the data</span></span>
<span id="cb222-28"><a href="#cb222-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-29"><a href="#cb222-29" aria-hidden="true" tabindex="-1"></a>kde <span class="ot">&lt;-</span> <span class="fu">bkde2D</span>(<span class="fu">cbind</span>(ccd_counties_proj<span class="sc">$</span>estimate_IPR_under50, </span>
<span id="cb222-30"><a href="#cb222-30" aria-hidden="true" tabindex="-1"></a>                    ccd_counties_proj<span class="sc">$</span>county_code09))</span>
<span id="cb222-31"><a href="#cb222-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-32"><a href="#cb222-32" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot estimates</span></span>
<span id="cb222-33"><a href="#cb222-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot kernel density estimate</span></span>
<span id="cb222-34"><a href="#cb222-34" aria-hidden="true" tabindex="-1"></a><span class="fu">image</span>(kde, <span class="at">main =</span> <span class="st">"Adaptive Bandwidth Kernel Density Estimation"</span>)</span>
<span id="cb222-35"><a href="#cb222-35" aria-hidden="true" tabindex="-1"></a><span class="fu">contour</span>(kde, <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb222-36"><a href="#cb222-36" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(ccd_counties_proj<span class="sc">$</span>estimate_IPR_under50, </span>
<span id="cb222-37"><a href="#cb222-37" aria-hidden="true" tabindex="-1"></a>                    ccd_counties_proj<span class="sc">$</span>county_code09,</span>
<span id="cb222-38"><a href="#cb222-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb222-39"><a href="#cb222-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Darker areas = greater density and smaller bandwidths</span></span>
<span id="cb222-40"><a href="#cb222-40" aria-hidden="true" tabindex="-1"></a><span class="co"># NCES used kriging, specifically Emprical Bayesian Kriging, which showed </span></span>
<span id="cb222-41"><a href="#cb222-41" aria-hidden="true" tabindex="-1"></a><span class="co"># different bandwidths for urban and rural communities</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="do">###??? This code chunk does not run properly due to unresolved errors in prior</span></span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a><span class="do">### slrm implicitly accounts for spatial dependence, incl lagged vers of dep</span></span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a><span class="do">### var as predictor in regression - avg val of DV in neighbors, weighted by</span></span>
<span id="cb223-5"><a href="#cb223-5" aria-hidden="true" tabindex="-1"></a><span class="do">### spatial relationships id'd in weights matrix</span></span>
<span id="cb223-6"><a href="#cb223-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-7"><a href="#cb223-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert estimate_IPR_under50 to binary indicator</span></span>
<span id="cb223-8"><a href="#cb223-8" aria-hidden="true" tabindex="-1"></a>ccd_counties_proj <span class="ot">&lt;-</span> ccd_counties_proj <span class="sc">%&gt;%</span></span>
<span id="cb223-9"><a href="#cb223-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb223-10"><a href="#cb223-10" aria-hidden="true" tabindex="-1"></a>    binary_ipr <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb223-11"><a href="#cb223-11" aria-hidden="true" tabindex="-1"></a>      <span class="sc">!</span><span class="fu">is.na</span>(counties_sf<span class="sc">$</span>estimate_IPR_under50) <span class="sc">&amp;</span> </span>
<span id="cb223-12"><a href="#cb223-12" aria-hidden="true" tabindex="-1"></a>        counties_sf<span class="sc">$</span>estimate_IPR_under50 <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)   </span>
<span id="cb223-13"><a href="#cb223-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb223-14"><a href="#cb223-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-15"><a href="#cb223-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-16"><a href="#cb223-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Run the model</span></span>
<span id="cb223-17"><a href="#cb223-17" aria-hidden="true" tabindex="-1"></a>IPR_under50_slrm <span class="ot">&lt;-</span> <span class="fu">slrm</span>(</span>
<span id="cb223-18"><a href="#cb223-18" aria-hidden="true" tabindex="-1"></a>  binary_ipr <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb223-19"><a href="#cb223-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> ccd_counties_proj,</span>
<span id="cb223-20"><a href="#cb223-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">listw =</span> <span class="fu">poly2nb</span> (ccd_counties_proj),</span>
<span id="cb223-21"><a href="#cb223-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> binomial)</span>
<span id="cb223-22"><a href="#cb223-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-23"><a href="#cb223-23" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_slm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>{</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="co"># RESEARCH QUESTIONS</span></span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a><span class="co"># For the purpose of this sample project, the research question was whether a spatial relationship exists between the distribution of schools and the proportion of the population with a household income under 50 percent of the poverty rate (IPR &lt; .50). The necessary analytic steps should provide a parallel to my dissertation questions re. course access and participation. Dissertation questions below:</span></span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-5"><a href="#cb224-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Does access to, and participation in, academically rigorous courses vary geographically? Academic rigor is defined as curricular intensity, or highest level math course offered/completed, core science courses offered/completed (biology, chemistry, physics), and participation in at least one Advanced Placement course. </span></span>
<span id="cb224-6"><a href="#cb224-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-7"><a href="#cb224-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Does the impact of course access and participation vary geographically, according to whether students live in an urban, suburban, town, or rural community (and their sub-types)? Does the impact of where students live vary by subgroup, e.g., females vs. males, by racial/ethnic group, or student socioeconomic status? Outcomes include enrollment in a two-year institution within (measured at one and two years after high school), enrollment in a four-year institution (one or two years after high school), participation in the workforce or military (one or two years after high school), or degree completion within six years after high school. </span></span>
<span id="cb224-8"><a href="#cb224-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-9"><a href="#cb224-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Are certain community characteristics associated with the likelihood of a school  offering academically rigorous courses, including racial/ethnic composition, median income, poverty status, educational attainment, industrial structure, or geographic locale?</span></span>
<span id="cb224-10"><a href="#cb224-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-11"><a href="#cb224-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Does moving from a high-opportunity high school (full course access all four years of high school) to a low-opportunity high school (less than full course access) impact student outcomes? Does any impact vary by student subgroup or school locale?</span></span>
<span id="cb224-12"><a href="#cb224-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-13"><a href="#cb224-13" aria-hidden="true" tabindex="-1"></a><span class="co">#  WHY INTERESTED</span></span>
<span id="cb224-14"><a href="#cb224-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-15"><a href="#cb224-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   A substantive body of evidence tells us that the educational institutions youth attend reflect the communities in which they live, with the result that students act and make choices in environments that both enable and constrain (National Academies of Sciences, 2019). Thus, persistent between-group differences in education outcomes are important to monitor because they signal disparities in the kinds opportunity structures with which students engage. Course taking in high school represents an important site of inequality that contributes to disparate educational outcomes (Adelman, 2002, 2006; Attewell &amp; Domina, 2008; Long et al., 2012; National Academies of Sciences, 2019). Although definitions of college and career readiness vary, experts consistently identify rigorous academic course taking as a central component (Austin, 2019; Hogrebe &amp; Tate, 2017) and research demonstrates that access to such coursework varies by student race/ethnicity, socioeconomic status, and/or geographic context (Castro, 2021; Kolluri, 2018; Price, 2021; Xu et al., 2021).  Numerous studies have found that high school academic preparation is a consistently strong contributor to youth higher education outcomes (Austin, 2019; Byun et al., 2015; Byun, Irvin et al., 2012; Byun, Meece, et al., 2012; Irvin et al., 2017; Schmitt-Wilson &amp; Byun, 2021, Wells et al., 2019). However, research at both national and state levels highlight examples of rural students having less access to advanced math, advanced science, and Advanced Placement courses (Gagnon &amp; Mattingly, 2016; Hogrebe &amp; Tate, 2017; Irvin et al., 2016, 2017; Provasnik et al., 2007; Saw &amp; Agger, 2021). </span></span>
<span id="cb224-16"><a href="#cb224-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-17"><a href="#cb224-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   Yet state and federal policy approaches tend to treat rural, suburban, and urban school systems the same, without attention to their varied organizational structures, student populations, histories, cultures, and fiscal capacity (J. Johnson &amp; Howley, 2015). Rural communities often have lower property values and more undeveloped land, resulting in a lower tax base with which to support public education (Johnson &amp; Zoellner, 2016). Because of this, funding systems that rely heavily on local funds are generally less equitable than those in which state funds play a larger role, and state-level approaches vary significantly. In addition, state and federal approaches to providing supplemental funds via competitive grants leave out the many rural districts with smaller staffs and limited proposal writing capacity (Brenner, 2023; J. Johnson &amp; Zoellner, 2016). Further, communities with relatively smaller populations and geographic distance from population centers face increased costs due to geographic remoteness, harsh weather, and/or poor roads. Limited broadband access (Dobis et al., 2021) and travel time for resources best accessed in-person also present challenges. Policies and funding mechanisms intended to address these challenges have often not accounted for variability within and across rural districts and often provide relatively limited additional support (J. Johnson &amp; Howley, 2015). Rural scholars and community stakeholders have recognized the need for greater attention to the geographic variation in opportunity and called for centering future research efforts around spatial equity, with attention to its intersection with diverse identities and social circumstances (Hartman et al., 2022). Multiple areas where future research is needed have been identified, among them college and career trajectories, access to advanced and accelerated coursework, and understanding what happens after students leave their local communities.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DATA. </span></span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a><span class="co"># High School Longitudinal Study (HSLS:2009). This study draws on restricted-use student- and school-level data from the HSLS:2009. Conducted by National Center for Education Statistics, HSLS:2009 provides longitudinal, nationally-representative data on academic participation and outcomes for students who started 9th grade in 2009. This study uniquely links high school catalog and student transcript data, postsecondary transcript data, and Community Population Survey data on workforce and armed services participation. All data analyses were conducted using R programming. </span></span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-5"><a href="#cb225-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Common Core of Data (CCD). In order to provide greater insight into spatial variation in educational opportunity, HSLS:2009 data have been combined with publicly-available data from the CCD. This allows linkage of individual student records to a fully-nuanced (Thier et al. , 2020) definition of locale. The public data disaggregate urban and suburban locales into large, midsize, or small, and disaggregate town and rural locales into fringe, distant, and remote, for a total of 12 locale classifications. The public data also provide county-level FIPS codes that allow linking of school and -county-level data. Data were downloaded from the Urban Institute's Educational Data Portal and were linked with HSLS data using NCES school identification numbers.</span></span>
<span id="cb225-6"><a href="#cb225-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-7"><a href="#cb225-7" aria-hidden="true" tabindex="-1"></a><span class="co"># U.S. Census American Community Survey (ACS). County-level indicators of key community social and economic characteristics come from the five-year ACS. The 2013 5-year data reflect averages across the years of 2009-2013 and demonstrate the least sampling error (Cowan et al., 2020; Dillingham et al., 2020). Key inequality risk factors include community-level ethno-racial composition, median household income, poverty, unemployment rates, educational attainment, and occupational structure (Thiede, et al., 2022; Butler et al., 2022; Jargowsky &amp; Tursi (2015). ACS data were linked to HSLS and CCD data using state and county FIPS codes.</span></span>
<span id="cb225-8"><a href="#cb225-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-9"><a href="#cb225-9" aria-hidden="true" tabindex="-1"></a><span class="co"># PROCESSING STEPS</span></span>
<span id="cb225-10"><a href="#cb225-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-11"><a href="#cb225-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Becuse geospatial analytic methods have the potential to capture variance not measured with standard statistical approaches (Hogrebe &amp; Tate, 2017), this study applies spatial logistic regression. This allows for measurement of the relationship between a binary outcome variable (e.g., enrollment in a 2-year institution within one year of high school, or not) while taking into account spatial variation in the context of observations. </span></span>
<span id="cb225-12"><a href="#cb225-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-13"><a href="#cb225-13" aria-hidden="true" tabindex="-1"></a><span class="co"># The county-level shapefile for all counties in the US was downloaded directly into the R environment using the tigris package. Attribute data for each indicator was downloaded as separate dataframe objects. NCES data were also downloaded directly into R, also as dataframes, using the Urban Institutes educationdata package. Both the Census and CCD dataframe objects were trimmed of outlying areas, reduced to only the needed variables, and iteratively merged. Because NCES data are nationally representative of students enrolled in 9th grade during 2009, left_join was using to joing later years of CCD files to the 2009 file. CCD files provide geographic information via school-level latitude and longitude coordinates. After the census attribute files were merged, assigned the same Coordingate Reference System as the Census county-level shape file.  </span></span>
<span id="cb225-14"><a href="#cb225-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-15"><a href="#cb225-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Ripley's K was then used to identify whether outcome and predictor variables exhibit spatial autocorrelation, or that observations near each other tend to be more similar than observations that are father apart. Adaptive bandwith allows for bandwidth estimation that responds to the properties of the local data. Spatial logistic regression followed, suing the slrm function because it implicitly accounts for spatial dependence. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pending correction of errors</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Also , pending correction of errors </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="co"># How well does my project demonstrate that I achieved my objectives?</span></span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-3"><a href="#cb228-3" aria-hidden="true" tabindex="-1"></a><span class="co"># I knew my objectives were ambitious and this project demonstrates that my objectives were very, very, very ambitious, given my starting point. However, coming to this course completely new to geostats, completely new to R, a little rusty on standard stats, and with vision challenges, I feel that I have accomplished a a lot. My understanding of the concepts definitely starts to weaken with assignment 7 - auto correlation and interpolation, continuing through statistical modeling and movement/networks. I also ran into challenges with basic file joining that I was not able to resolve by reviewing my notes/reading materials. Given this, I was unable to complete several major sections of the final assignment. I think working with Census and CCD data files was more complicated than I anticipated. I thought it would be less error prone than self-collected data but the data files are large and contained some surprises re. missing cases. I'm not entirely confident that Ripley's K, adaptive bandwidth estimation, and spatial logistic regression are the correct approaches but this process has been really helpful preparation for my dissertation. In terms of a grade, I'm hopeful that I would qualify for a B...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>